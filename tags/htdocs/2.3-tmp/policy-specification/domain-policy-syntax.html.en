<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en-US">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="content-style-type" content="text/css">
<link rel="stylesheet" href="../../media/tomoyolinux.css" media="all" type="text/css">
<title>TOMOYO Linux 1.8.x : Policy specification : Domain policy syntax</title>
</head>

<body>

<div id="titlebar">
<a href="../../index.html.en"><img src="../../media/tomoyotitle.png" alt="tomoyotitle.png" width="320" height="40" border="0" align="left"></a>
</div>

<div id="navbar" class="tomoyo-documentation">
<ul id="navbarlist">
<li id="tomoyo-home"><a href="../../index.html.en" title="TOMOYO Linux Home Page">Home</a></li>
<li id="tomoyo-about"><a href="../../about.html.en" title="About TOMOYO Linux">About</a></li>
<li id="tomoyo-download"><a href="../../download.html.en" title="Get TOMOYO Linux">Download</a></li>
<li id="tomoyo-changelogs"><a href="../../changelogs.html.en" title="TOMOYO Linux ChangeLogs">ChangeLogs</a></li>
<li id="tomoyo-documentation"><a href="../../documentation.html.en" title="Official Documentation">Documentation</a></li>
<li id="tomoyo-support"><a href="../../support.html.en" title="Support information">Support</a></li>
<li id="tomoyo-links"><a href="../../links.html.en" title="Links">Links</a></li>
</ul>
<ul id="switch-language">
<li id="tomoyo-switch-language"><a href="domain-policy-syntax.html.ja" title="Go to Japanese page">Japanese page</a></li>
</ul>
</div>

<div id="content">

<div id="documentation">

<div id="navheader">
<p><a href="exception-policy-syntax.html.en">&lt;Prev&gt;</a> <a href="index.html.en">&lt;Index&gt;</a></p>
</div>

<h2>Domain policy syntax</h2>

<h3><a name="file_execute">file execute</a></h3>

<p>This directive allows execution of the specified pathname.</p>

<p>This example allows the domain to execute <code>/bin/ls</code>:</p>

<pre>
file execute /bin/ls
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#aggregator">aggregator</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_read">file read</a></h3>

<p>This directive allows the domain to open the specified pathname for reading.</p>

<p>This example allows the domain to read "/proc/meminfo":</p>

<pre>
file read proc:/meminfo
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_write">file write</a></h3>

<p>This directive allows the domain to open the specified pathname for writing.</p>

<p>This example allows the domain to write to "/dev/null":</p>

<pre>
file write /dev/null
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_append">file append</a></h3>

<p>This directive allows the domain to append to the specified pathname.</p>

<p>This example allows the domain to append to the file "/var/log/auth.log":</p>

<pre>
file append /var/log/auth.log
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_create">file create</a></h3>

<p>This directive allows the domain to create the specified file with the specified permissions.</p>

<p>This example allows the domain to create the file "/var/lock/subsys/crond":</p>

<pre>
file create /var/lock/subsys/crond 0644
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_unlink">file unlink</a></h3>

<p>This directive allows the domain to delete the specified pathname.</p>

<p>This example allows the domain to delete the file "/var/lock/subsys/crond":</p>

<pre>
file unlink /var/lock/subsys/crond
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_chown">file chown</a></h3>

<p>This directive allows the domain to change the user ownership of the specified pathname to the specified UID.</p>

<p>This example allows the domain to change the owner of "/dev/sda" to UID=0:</p>

<pre>
file chown /dev/sda 0
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_chgrp">file chgrp</a></h3>

<p>This directive allows the domain to change group ownership of the specified pathname to the specified GID.</p>

<p>This example allows the domain to change the GID of "/dev/audio" to 92:</p>

<pre>
file chgrp /dev/audio 92
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_chmod">file chmod</a></h3>

<p>This directive allows the domain to change permissions of the specified pathname to the specified octal permissions.</p>

<p>This example allows the domain to change the octal permissions of "/dev/mem" to 0644:</p>

<pre>
file chmod /dev/mem 0644
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_mkdir">file mkdir</a></h3>

<p>This directive allows the domain to create the specified directory with the specified permissions.</p>

<p>This example allows the domain to create directories that match "/tmp/logwatch.\*/":</p>

<pre>
file mkdir /tmp/logwatch.\*/ 0755
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_rmdir">file rmdir</a></h3>

<p>This directive allows the domain to delete the specified directory.</p>

<p>This example allows the domain to delete directories that match "/tmp/logwatch.\*/":</p>

<pre>
file rmdir /tmp/logwatch.\*/
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_mkfifo">file mkfifo</a></h3>

<p>This directive allows the domain to create the specified FIFO with the specified permissions.</p>

<p>This example allows the domain to create the FIFO "/dev/initctl":</p>

<pre>
file mkfifo /dev/initctl 0644
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_mksock">file mksock</a></h3>

<p>This directive allows the domain to create the specified socket with the specified permissions.</p>

<p>This example allows the domain to create the socket "/dev/log":</p>

<pre>
file mksock /dev/log 0755
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_mkblock">file mkblock</a></h3>

<p>This directive allows the domain to create the specified block device with the specified permissions, major number and minor number.</p>

<p>This example allows the domain to create the block device "/dev/loop0":</p>

<pre>
file mkblock /dev/loop0 0600 7 0
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_mkchar">file mkchar</a></h3>

<p>This directive allows the domain to create the specified character device with the specified permissions, major number and minor number.</p>

<p>This example allows the domain to create the character device "/dev/console":</p>

<pre>
file mkchar /dev/console 0755 5 1
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_truncate">file truncate</a></h3>

<p>This directive allows the domain to truncate or extend the specified pathname.</p>

<p>This example allows the domain to truncate the contents of "/etc/mtab":</p>

<pre>
file truncate /etc/mtab
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_symlink">file symlink</a></h3>

<p>This directive allows the domain to symlink the specified pathname.</p>

<p>This example allows the domain to symlink "/dev/cdrom":</p>

<pre>
file symlink /dev/cdrom
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_link">file link</a></h3>

<p>This directive allows the domain to create hard linkÂ between the first and second specified pathnames.</p>

<p>This example allows a hard link to be created between pathnames that match "/etc/mtab~\$" and "/etc/mtab~":</p>

<pre>
file link /etc/mtab~\$ /etc/mtab~
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_rename">file rename</a></h3>

<p>This directive allows the domain to rename the first specified pathname to the second specified pathname.</p>

<p>This example allows "/etc/mtab.tmp" to be renamed "/etc/mtab":</p>

<pre>
file rename /etc/mtab.tmp /etc/mtab
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_ioctl">file ioctl</a></h3>

<p>This directive allows the domain to make an ioctl request with the specified command number. For information on the ioctl command numbers, refer to manuals provided by each module with ioctl functionality.</p>

<p>This example allows the domain to issue an ioctl request with command number 0x8915 (i.e. SIOCGIFADDR request) on sockets with family = 2, type = 2, protocol = 17 (i.e. UDP/IPv4 sockets):</p>

<pre>
file ioctl socket:[family=2:type=2:protocol=17] 0x8915
</pre>

<p>This example allows the domain to issue an ioctl request with command numbers between 10000 and 20000 on "/dev/null":</p>

<pre>
file ioctl /dev/null 10000-20000
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_mount">file mount</a></h3>

<p>This directive allows the domain to mount a filesystem with the specified devices, pathnames and options.</p>

<p>The syntax is: "<strong>file mount $DEVICE $MOUNTPOINT $FILESYSTEM $OPTIONS</strong>". If $FILESYSTEM requires a device file, a block device file's pathname is specified for $DEVICE. The $OPTIONS is a hexadecimal (or otcal or decimal) integer expression. The following options can also be specified for $FILESYSTEM:</p>

<ul>
<li>--bind</li>
<li>--move</li>
<li>--remount</li>
<li>--make-unbindable</li>
<li>--make-private</li>
<li>--make-slave</li>
<li>--make-shared</li>
</ul>

<p>This example allows the domain to remount the / directory:</p>

<pre>
file mount any / --remount 0x0
</pre>

<p>This example allows the domain to mount "/dev/hdc" which was formatted as an ext3 filesystem at "/var/www/" directory:</p>

<pre>
file mount /dev/hdc /var/www/ ext3 0xF
</pre>

<p>This example allows the domain to mount a tmpfs filesystem at "/dev/shm/" directory:</p>

<pre>
file mount none /dev/shm/ tmpfs 0xE
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_unmount">file unmount</a></h3>

<p>This directive allows the domain to unmount a filesystem from the specified pathname.</p>

<p>This example allows the domain to unmount the filesystem mounted at "/mnt/cdrom/" directory:</p>

<pre>
file unmount /mnt/cdrom/
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_chroot">file chroot</a></h3>

<p>This directive allows the domain to use the specified pathname as a new / directory.</p>

<p>This example allows the domain to use "/var/empty/sshd/" as a new / directory:</p>

<pre>
file chroot /var/empty/sshd/
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="file_pivot_root">file pivot_root</a></h3>

<p>This directive allows the domain to use the first specified pathname as a new / directory and bring the old / directory to the second specified pathname.</p>

<p>This functionality is generally used for only once for switching the / directory from initrd/initramfs to the hard drive, which generally occurs before TOMOYO Linux has been activated. It is therefore unlikely that you will need this directive.</p>

<p>This example allows the domain to use "/proc/" as a new / directory and bring the old / directory to "/proc/ccs/" directory:</p>

<pre>
file pivot_root proc:/ proc:/ccs/
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="use_profile">use_profile</a></h3>

<p>This directive is changes the profile number of the domain.</p>

<p>This example changes the profile number of the domain to 3:</p>

<pre>
use_profile 3
</pre>

<h3><a name="quota_exceeded">quota_exceeded</a></h3>

<p>This directive indicates that the domain has failed to append an entry while in "Learning Mode" due to the "max_learning_entry" value being reached.</p>

<h3><a name="transition_failed">transition_failed</a></h3>

<p>This directive indicates that a process within this domain was not able to undergo a domain transition following an execute request.</p>

<p>This problem occurs, in order to avoid access denials by TOMOYO unless enforcing mode is used, due to TOMOYO accepting program execution requests unless enforcing mode even if domain transition has failed. The cause of this problem is either the name of the domain being too long, or the kernel being unable to allocate memory. To fix this problem, either suppress domain transitions or increase the memory quota which TOMOYO can use.</p>

</div><!-- documentation -->

</div><!-- content -->

<div id="navfooter">
<hr>
<table>
<tr>
<td class="docs-previous">
<a href="exception-policy-syntax.html.en">Prev</a>
</td>
<td class="docs-index">
<a href="index.html.en">Index</a>
</td>
<td class="docs-next">
</td>
</tr>
<tr>
<td class="docs-previous-description">
<p>A4: Exception policy syntax</p>
</td>
<td class="docs-home">
<a href="../index.html.en">Main Index</a>
</td>
<td class="docs-next-description">
</td>
</tr>
</table>
</div>

<div id="footer">
<p class="language">Go to <a href="domain-policy-syntax.html.ja">Japanese page</a>.</p>
<p class="timestamp">Last modified: $Date$</p>
<p class="trademark">Linux&reg; is a registered trademark of Linus Torvalds world-wide. TOMOYO&reg; is a registered trademark of <a href="http://www.nttdata.co.jp/en/">NTT DATA Corporation</a>.</p>
<p><a href="http://sourceforge.jp/"><img src="http://sourceforge.jp/sflogo.php?group_id=1973" width="96" height="31" alt="SourceForge.jp"></a></p>
</div>

</body>
</html>
