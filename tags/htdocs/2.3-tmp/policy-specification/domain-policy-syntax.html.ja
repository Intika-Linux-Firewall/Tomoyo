<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="ja-JP">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="content-style-type" content="text/css">
<link rel="stylesheet" href="../../media/tomoyolinux.css" media="all" type="text/css">
<title>TOMOYO Linux 2.3.x : ポリシー仕様 : ドメインポリシー構文</title>
</head>

<body>

<div id="titlebar">
<a href="../../index.html.ja"><img src="../../media/tomoyotitle.png" alt="tomoyotitle.png" width="320" height="40" border="0" align="left"></a>
</div>

<div id="navbar" class="tomoyo-documentation">
<ul id="navbarlist">
<li id="tomoyo-home"><a href="../../index.html.ja" title="TOMOYO Linux ホーム">ホーム</a></li>
<li id="tomoyo-about"><a href="../../about.html.ja" title="TOMOYO Linux の詳細">詳細</a></li>
<li id="tomoyo-download"><a href="../../download.html.ja" title="TOMOYO Linux を入手">ダウンロード</a></li>
<li id="tomoyo-changelogs"><a href="../../changelogs.html.ja" title="TOMOYO Linux 変更履歴">変更履歴</a></li>
<li id="tomoyo-documentation"><a href="../../documentation.html.ja" title="公式ドキュメント">ドキュメント</a></li>
<li id="tomoyo-support"><a href="../../support.html.ja" title="サポート情報">サポート</a></li>
<li id="tomoyo-links"><a href="../../links.html.ja" title="Links">リンク</a></li>
</ul>
<ul id="switch-language">
<li id="tomoyo-switch-language"><a href="domain-policy-syntax.html.en" title="Go to English page">English page</a></li>
</ul>
</div>

<div id="content">

<div id="documentation">

<div id="navheader">
<p><a href="exception-policy-syntax.html.ja">&lt;前&gt;</a> <a href="index.html.ja">&lt;目次&gt;</a></p>
</div>

<h2>ドメインポリシー構文</h2>

<h3><a name="file_execute">allow_execute</a></h3>

<p>このディレクティブは、指定されたパス名の実行を許可します。</p>

<p>以下の例では <code>/bin/ls</code> の実行を許可しています：</p>

<pre>
allow_execute /bin/ls
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#aggregator">aggregator</a></li>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_read">allow_read</a></h3>

<p>このディレクティブは、指定されたパス名を読み込みモードでオープンすることを許可します。</p>

<p>以下の例では /proc/meminfo の参照を許可しています：</p>

<pre>
allow_read /proc/meminfo
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_write">allow_write</a></h3>

<p>このディレクティブは、指定されたパス名を書き込みモードでオープンすることを許可します。</p>

<p>以下の例では /dev/null への書き込みを許可しています：</p>

<pre>
allow_write /dev/null
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_read/write">allow_read/write</a></h3>

<p>このディレクティブは、指定されたパス名を読み書きモードでオープンすることを許可します。</p>

<p>以下の例では /dev/null への読み書きを許可しています：</p>

<pre>
allow_read/write /dev/null
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_create">allow_create</a></h3>

<p>このディレクティブは、指定されたファイルを指定されたパーミッションで作成することを許可します。</p>

<p>以下の例では /var/lock/subsys/crond の作成を許可しています：</p>

<pre>
allow_create /var/lock/subsys/crond 0644
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_unlink">allow_unlink</a></h3>

<p>このディレクティブは、指定されたパス名を削除することを許可します。</p>

<p>以下の例では /var/lock/subsys/crond の削除を許可しています：</p>

<pre>
allow_unlink /var/lock/subsys/crond
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_chown">allow_chown</a></h3>

<p>このディレクティブは、指定されたパス名の所有者を指定されたユーザＩＤに変更することを許可します。</p>

<p>以下の例では /dev/sda の所有者のユーザＩＤを 0 に設定することを許可しています：</p>

<pre>
allow_chown /dev/sda 0
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_chgrp">allow_chgrp</a></h3>

<p>このディレクティブは、指定されたパス名のグループを指定されたグループＩＤに変更することを許可します。</p>

<p>以下の例では /dev/audio のグループのグループＩＤを 92 に設定することを許可しています：</p>

<pre>
allow_chgrp /dev/audio 92
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_chmod">allow_chmod</a></h3>

<p>このディレクティブは、指定されたパス名のパーミッションを指定された数値に変更することを許可します。</p>

<p>以下の例では /dev/mem のパーミッションを 0644 に設定することを許可しています：</p>

<pre>
allow_chmod /dev/mem 0644
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_mkdir">allow_mkdir</a></h3>

<p>このディレクティブは、指定されたパス名のディレクトリを指定されたパーミッションで作成することを許可します。</p>

<p>以下の例では /tmp/logwatch.\*/ というパターンに一致するディレクトリの作成を許可しています：</p>

<pre>
allow_mkdir /tmp/logwatch.\*/ 0755
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_rmdir">allow_rmdir</a></h3>

<p>このディレクティブは、指定されたディレクトリを削除することを許可します。</p>

<p>以下の例では /tmp/logwatch.\*/ というパターンに一致するディレクトリの削除を許可しています：</p>

<pre>
allow_rmdir /tmp/logwatch.\*/
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_mkfifo">allow_mkfifo</a></h3>

<p>このディレクティブは、指定されたＦＩＦＯを指定されたパーミッションで作成することを許可します。</p>

<p>以下の例では /dev/initctl という名前のＦＩＦＯの作成を許可しています：</p>

<pre>
allow_mkfifo /dev/initctl 0644
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_mksock">allow_mksock</a></h3>

<p>このディレクティブは、指定されたソケットを指定されたパーミッションで作成することを許可します。</p>

<p>以下の例では /dev/log という名前のソケットの作成を許可しています：</p>

<pre>
allow_mksock /dev/log 0755
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_mkblock">allow_mkblock</a></h3>

<p>このディレクティブは、指定されたブロックデバイスを指定されたパーミッションおよびメジャー番号／マイナー番号で作成することを許可します。</p>

<p>以下の例では /dev/loop0 というブロックデバイスの作成を許可しています：</p>

<pre>
allow_mkblock /dev/loop0 0600 7 0
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_mkchar">allow_mkchar</a></h3>

<p>このディレクティブは、指定されたキャラクタデバイスを指定されたパーミッションおよびメジャー番号／マイナー番号で作成することを許可します。</p>

<p>以下の例では /dev/console というキャラクタデバイスの作成を許可しています：</p>

<pre>
allow_mkchar /dev/console 0755 5 1
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_truncate">allow_truncate</a></h3>

<p>このディレクティブは、指定されたパス名を切り詰めたり伸長したりすることを許可します。</p>

<p>以下の例では /etc/mtab を切り詰めることを許可しています：</p>

<pre>
allow_truncate /etc/mtab
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_symlink">allow_symlink</a></h3>

<p>このディレクティブは、指定されたシンボリックリンクを作成することを許可します。</p>

<p>以下の例では /dev/cdrom というシンボリックリンクの作成を許可しています：</p>

<pre>
allow_symlink /dev/cdrom
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_link">allow_link</a></h3>

<p>このディレクティブは、１番目に指定されたパス名と２番目に指定されたパス名とでハードリンクを作成することを許可します。</p>

<p>以下の例では /etc/mtab~\$ というパターンに一致するパス名と /etc/mtab~ というパス名とでハードリンクを作成することを許可しています：</p>

<pre>
allow_link /etc/mtab~\$ /etc/mtab~
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_rename">allow_rename</a></h3>

<p>このディレクティブは、１番目に指定されたパス名から２番目に指定されたパス名にリネームすることを許可します。</p>

<p>以下の例では /etc/mtab.tmp というパス名を /etc/mtab というパス名にリネームすることを許可しています：</p>

<pre>
allow_rename /etc/mtab.tmp /etc/mtab
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_rewrite">allow_rewrite</a></h3>

<p>このディレクティブは <a href="exception-policy-syntax.html.ja#deny_rewrite">deny_rewrite</a> ディレクティブの効果を打ち消すために使用します。</p>

<p>以下の例では deny_rewrite /var/log/\* という指定を打ち消しています：</p>

<pre>
allow_rewrite /var/log/\*
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#deny_rewrite">deny_rewrite</a></li>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_ioctl">allow_ioctl</a></h3>

<p>このディレクティブは、指定されたパス名に対して指定されたコマンド番号の ioctl 要求を行うことを許可します。 ioctl のコマンド番号については、対象となるモジュールの ioctl 機能の説明を参照してください。</p>

<p>以下の例ではファミリーが２、タイプが２、プロトコルが１７のソケット（ＵＤＰ／ＩＰｖ４ソケット）に対して、 0x8915 番の ioctl 要求（ SIOCGIFADDR 要求）を行うことを許可しています：</p>

<pre>
allow_ioctl socket:[family=2:type=2:protocol=17] 0x8915
</pre>

<p>以下の例では /dev/null に対して 10000 ～ 20000 番の ioctl 要求を行うことを許可しています：</p>

<pre>
allow_ioctl /dev/null 10000-20000
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_mount">allow_mount</a></h3>

<p>このディレクティブは、指定されたデバイス／ファイルシステムタイプ／マウントオプションで指定されたマウントポイントにマウントすることを許可します。</p>

<p>構文は <strong>allow_mount $DEVICE $MOUNTPOINT $FILESYSTEM $OPTIONS</strong> です。 $FILESYSTEM がデバイスファイルを必要とする場合、 $DEVICE にはデバイスファイルを指定します。 $OPTIONS は１６進数（または８進数／１０進数）の整数です。 $FILESYSTEM には以下の値も指定できます：</p>

<ul>
<li>--bind</li>
<li>--move</li>
<li>--remount</li>
<li>--make-unbindable</li>
<li>--make-private</li>
<li>--make-slave</li>
<li>--make-shared</li>
</ul>

<p>以下の例では / ディレクトリの再マウントを許可しています：</p>

<pre>
allow_mount any / --remount 0x0
</pre>

<p>以下の例では ext3 ファイルシステムとしてフォーマットされた /dev/hdc を /var/www/ ディレクトリにマウントすることを許可しています：</p>

<pre>
allow_mount /dev/hdc /var/www/ ext3 0xF
</pre>

<p>以下の例では /dev/shm/ ディレクトリに tmpfs ファイルシステムをマウントすることを許可しています：</p>

<pre>
allow_mount none /dev/shm/ tmpfs 0xE
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_unmount">allow_unmount</a></h3>

<p>このディレクティブは、指定されたパス名をアンマウントすることを許可します。</p>

<p>以下の例では /mnt/cdrom/ ディレクトリをアンマウントすることを許可しています：</p>

<pre>
allow_unmount /mnt/cdrom/
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_chroot">allow_chroot</a></h3>

<p>このディレクティブは、指定されたパス名を新しい / ディレクトリに設定することを許可します。</p>

<p>以下の例では /var/empty/sshd/ を新しい / ディレクトリに設定することを許可しています：</p>

<pre>
allow_chroot /var/empty/sshd/
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="file_pivot_root">allow_pivot_root</a></h3>

<p>このディレクティブは、１番目に指定されたパス名を新しい / ディレクトリに設定し、古い / ディレクトリを２番目に指定されたパス名へと移動させることを許可します。</p>

<p>この機能は通常、 initrd/initramfs が使用していた / ディレクトリからハードディスクが使用する / ディレクトリへと切り替えるために１回だけ呼ばれます。この機能は通常、 TOMOYO Linux が有効にされるよりも前に呼び出されるため、このディレクティブが必要になることは滅多にありません。</p>

<p>以下の例では /sys/kernel/security/ を新しい / ディレクトリに設定し、古い / ディレクトリを /sys/kernel/security/tomoyo/ に移動させることを許可しています：</p>

<pre>
allow_pivot_root /sys/kernel/security/ /sys/kernel/security/tomoyo/
</pre>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#path_group">path_group</a></li>
</ul>

<h3><a name="use_profile">use_profile</a></h3>

<p>このディレクティブは、ドメインに対して適用されるプロファイル番号を指定します。</p>

<p>以下の例ではドメインに対してプロファイル 3 を割り当てています：</p>

<pre>
use_profile 3
</pre>

<h3><a name="ignore_global_allow_read">ignore_global_allow_read</a></h3>

<p>このディレクティブは例外ポリシーで指定された <a href="exception-policy-syntax.html.ja#allow_read">allow_read</a> ディレクティブの効果を打ち消すために使用します。</p>

<p>参照：</p>
<ul>
<li><a href="exception-policy-syntax.html.ja#allow_read">allow_read</a></li>
</ul>

<h3><a name="quota_exceeded">quota_exceeded</a></h3>

<p>このディレクティブは、ドメインに対するアクセス許可の数がプロファイルの max_entry で指定された数に達したために、学習モードにおいて自動的に追加できなかったアクセス許可があることを示しています。</p>

<h3><a name="transition_failed">transition_failed</a></h3>

<p>このディレクティブは、プログラムの実行要求に対してドメイン遷移を行わないまま処理を継続したことを示しています。</p>

<p>これは、強制モードが割り当てられない限り TOMOYO が原因でアクセス拒否が発生しないようにするために、強制モードではない場合にはドメイン遷移に失敗してもプログラムの実行要求を受け入れるようにしているために発生します。ドメイン遷移が失敗する原因としては、ドメイン名が長すぎたか、ドメインを作成するためのメモリを割り当てられなかったかのどちらかです。この問題を修正するには、ドメイン遷移を抑制するか、 TOMOYO が使ってよいメモリ使用量の上限を増やしてください。</p>

</div><!-- documentation -->

</div><!-- content -->

<div id="navfooter">
<hr>
<table>
<tr>
<td class="docs-previous">
<a href="exception-policy-syntax.html.ja">前</a>
</td>
<td class="docs-index">
<a href="index.html.ja">目次</a>
</td>
<td class="docs-next">
</td>
</tr>
<tr>
<td class="docs-previous-description">
<p>A4: 例外ポリシー構文</p>
</td>
<td class="docs-home">
<a href="../index.html.ja">大目次</a>
</td>
<td class="docs-next-description">
</td>
</tr>
</table>
</div>

<div id="footer">
<p class="language">Go to <a href="domain-policy-syntax.html.en">English page</a>.</p>
<p class="timestamp">Last modified: $Date$</p>
<p class="trademark">Linux&reg; は世界各国における Linus Torvalds の登録商標です。 TOMOYO&reg; は<a href="http://www.nttdata.co.jp/">株式会社ＮＴＴデータ</a>の登録商標です。</p>
<p><a href="http://sourceforge.jp/"><img src="http://sourceforge.jp/sflogo.php?group_id=1973" width="96" height="31" alt="SourceForge.jp"></a></p>
</div>

</body>
</html>
