<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en-US">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="content-style-type" content="text/css">
<link rel="stylesheet" href="../../media/tomoyolinux.css" media="all" type="text/css">
<title>TOMOYO Linux 2.3.x : Policy specification : Domain policy syntax</title>
</head>

<body>

<div id="titlebar">
<a href="../../index.html.en"><img src="../../media/tomoyotitle.png" alt="tomoyotitle.png" width="320" height="40" border="0" align="left" title="TOMOYO Linux"></a>
</div>

<div id="navbar" class="tomoyo-documentation">
<ul id="navbarlist">
<li id="tomoyo-home"><a href="../../index.html.en" title="TOMOYO Linux Home Page">Home</a></li>
<li id="tomoyo-about"><a href="../../about.html.en" title="About TOMOYO Linux">About</a></li>
<li id="tomoyo-download"><a href="../../download.html.en" title="Get TOMOYO Linux">Download</a></li>
<li id="tomoyo-changelogs"><a href="../../changelogs.html.en" title="TOMOYO Linux ChangeLogs">ChangeLogs</a></li>
<li id="tomoyo-documentation"><a href="../../documentation.html.en" title="Official Documentation">Documentation</a></li>
<li id="tomoyo-support"><a href="../../support.html.en" title="Support information">Support</a></li>
<li id="tomoyo-links"><a href="../../links.html.en" title="Links">Links</a></li>
</ul>
<ul id="switch-language">
<li id="tomoyo-switch-language"><a href="domain-policy-syntax.html.ja" title="Go to Japanese page">Japanese page</a></li>
</ul>
</div>

<div id="content">

<div id="documentation">

<div id="navheader">
<p><a href="exception-policy-syntax.html.en">&lt;Prev&gt;</a> <a href="index.html.en">&lt;Index&gt;</a></p>
</div>

<h2>Domain policy syntax</h2>

<h3><a name="allow_execute">allow_execute</a></h3>

<p>This directive allows execution of the specified pathname.</p>

<p>This example allows the domain to execute <code>/bin/ls</code>:</p>

<pre>
allow_execute /bin/ls
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#aggregator">aggregator</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_read">allow_read</a></h3>

<p>This directive allows the domain to open the specified pathname for reading.</p>

<p>This example allows the domain to read "/proc/meminfo":</p>

<pre>
allow_read /proc/meminfo
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_write">allow_write</a></h3>

<p>This directive allows the domain to open the specified pathname for writing.</p>

<p>This example allows the domain to write to "/dev/null":</p>

<pre>
allow_write /dev/null
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_read/write">allow_read/write</a></h3>

<p>This directive allows the domain to open the specified pathname for reading and/or writing.</p>

<p>This example allows the domain to read and/or write to "/dev/null":</p>

<pre>
allow_read/write /dev/null
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_create">allow_create</a></h3>

<p>This directive allows the domain to create the specified file with the specified permissions.</p>

<p>This example allows the domain to create the file "/var/lock/subsys/crond":</p>

<pre>
allow_create /var/lock/subsys/crond 0644
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_unlink">allow_unlink</a></h3>

<p>This directive allows the domain to delete the specified pathname.</p>

<p>This example allows the domain to delete the file "/var/lock/subsys/crond":</p>

<pre>
allow_unlink /var/lock/subsys/crond
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_chown">allow_chown</a></h3>

<p>This directive allows the domain to change the user ownership of the specified pathname to the specified UID.</p>

<p>This example allows the domain to change the owner of "/dev/sda" to UID=0:</p>

<pre>
allow_chown /dev/sda 0
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_chgrp">allow_chgrp</a></h3>

<p>This directive allows the domain to change group ownership of the specified pathname to the specified GID.</p>

<p>This example allows the domain to change the GID of "/dev/audio" to 92:</p>

<pre>
allow_chgrp /dev/audio 92
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_chmod">allow_chmod</a></h3>

<p>This directive allows the domain to change permissions of the specified pathname to the specified octal permissions.</p>

<p>This example allows the domain to change the octal permissions of "/dev/mem" to 0644:</p>

<pre>
allow_chmod /dev/mem 0644
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_mkdir">allow_mkdir</a></h3>

<p>This directive allows the domain to create the specified directory with the specified permissions.</p>

<p>This example allows the domain to create directories that match "/tmp/logwatch.\*/":</p>

<pre>
allow_mkdir /tmp/logwatch.\*/ 0755
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_rmdir">allow_rmdir</a></h3>

<p>This directive allows the domain to delete the specified directory.</p>

<p>This example allows the domain to delete directories that match "/tmp/logwatch.\*/":</p>

<pre>
allow_rmdir /tmp/logwatch.\*/
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_mkfifo">allow_mkfifo</a></h3>

<p>This directive allows the domain to create the specified FIFO with the specified permissions.</p>

<p>This example allows the domain to create the FIFO "/dev/initctl":</p>

<pre>
allow_mkfifo /dev/initctl 0644
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_mksock">allow_mksock</a></h3>

<p>This directive allows the domain to create the specified socket with the specified permissions.</p>

<p>This example allows the domain to create the socket "/dev/log":</p>

<pre>
allow_mksock /dev/log 0755
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_mkblock">allow_mkblock</a></h3>

<p>This directive allows the domain to create the specified block device with the specified permissions, major number and minor number.</p>

<p>This example allows the domain to create the block device "/dev/loop0":</p>

<pre>
allow_mkblock /dev/loop0 0600 7 0
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_mkchar">allow_mkchar</a></h3>

<p>This directive allows the domain to create the specified character device with the specified permissions, major number and minor number.</p>

<p>This example allows the domain to create the character device "/dev/console":</p>

<pre>
allow_mkchar /dev/console 0755 5 1
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_truncate">allow_truncate</a></h3>

<p>This directive allows the domain to truncate or extend the specified pathname.</p>

<p>This example allows the domain to truncate the contents of "/etc/mtab":</p>

<pre>
allow_truncate /etc/mtab
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_symlink">allow_symlink</a></h3>

<p>This directive allows the domain to symlink the specified pathname.</p>

<p>This example allows the domain to symlink "/dev/cdrom":</p>

<pre>
allow_symlink /dev/cdrom
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_link">allow_link</a></h3>

<p>This directive allows the domain to create hard link between the first and second specified pathnames.</p>

<p>This example allows a hard link to be created between pathnames that match "/etc/mtab~\$" and "/etc/mtab~":</p>

<pre>
allow_link /etc/mtab~\$ /etc/mtab~
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_rename">allow_rename</a></h3>

<p>This directive allows the domain to rename the first specified pathname to the second specified pathname.</p>

<p>This example allows "/etc/mtab.tmp" to be renamed "/etc/mtab":</p>

<pre>
allow_rename /etc/mtab.tmp /etc/mtab
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_rewrite">allow_rewrite</a></h3>

<p>This directive cancels the effect of <a href="exception-policy-syntax.html.en#deny_rewrite">deny_rewrite</a> directive.</p>

<p>This example cancels "deny_rewrite /var/log/\*":</p>

<pre>
allow_rewrite /var/log/\*
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#deny_rewrite">deny_rewrite</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_ioctl">allow_ioctl</a></h3>

<p>This directive allows the domain to make an ioctl request with the specified command number. For information on the ioctl command numbers, refer to manuals provided by each module with ioctl functionality.</p>

<p>This example allows the domain to issue an ioctl request with command number 0x8915 (i.e. SIOCGIFADDR request) on sockets with family = 2, type = 2, protocol = 17 (i.e. UDP/IPv4 sockets):</p>

<pre>
allow_ioctl socket:[family=2:type=2:protocol=17] 0x8915
</pre>

<p>This example allows the domain to issue an ioctl request with command numbers between 10000 and 20000 on "/dev/null":</p>

<pre>
allow_ioctl /dev/null 10000-20000
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_mount">allow_mount</a></h3>

<p>This directive allows the domain to mount a filesystem with the specified devices, pathnames and options.</p>

<p>The syntax is: "<strong>allow_mount $DEVICE $MOUNTPOINT $FILESYSTEM $OPTIONS</strong>". If $FILESYSTEM requires a device file, a block device file's pathname is specified for $DEVICE. The $OPTIONS is a hexadecimal (or otcal or decimal) integer expression. The following options can also be specified for $FILESYSTEM:</p>

<ul>
<li>--bind</li>
<li>--move</li>
<li>--remount</li>
<li>--make-unbindable</li>
<li>--make-private</li>
<li>--make-slave</li>
<li>--make-shared</li>
</ul>

<p>This example allows the domain to remount the / directory:</p>

<pre>
allow_mount any / --remount 0x0
</pre>

<p>This example allows the domain to mount "/dev/hdc" which was formatted as an ext3 filesystem at "/var/www/" directory:</p>

<pre>
allow_mount /dev/hdc /var/www/ ext3 0xF
</pre>

<p>This example allows the domain to mount a tmpfs filesystem at "/dev/shm/" directory:</p>

<pre>
allow_mount none /dev/shm/ tmpfs 0xE
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#number_group">number_group</a></li>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_unmount">allow_unmount</a></h3>

<p>This directive allows the domain to unmount a filesystem from the specified pathname.</p>

<p>This example allows the domain to unmount the filesystem mounted at "/mnt/cdrom/" directory:</p>

<pre>
allow_unmount /mnt/cdrom/
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_chroot">allow_chroot</a></h3>

<p>This directive allows the domain to use the specified pathname as a new / directory.</p>

<p>This example allows the domain to use "/var/empty/sshd/" as a new / directory:</p>

<pre>
allow_chroot /var/empty/sshd/
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="allow_pivot_root">allow_pivot_root</a></h3>

<p>This directive allows the domain to use the first specified pathname as a new / directory and bring the old / directory to the second specified pathname.</p>

<p>This functionality is generally used for only once for switching the / directory from initrd/initramfs to the hard drive, which generally occurs before TOMOYO Linux has been activated. It is therefore unlikely that you will need this directive.</p>

<p>This example allows the domain to use "/sys/kernel/security/" as a new / directory and bring the old / directory to "/sys/kernel/security/tomoyo/" directory:</p>

<pre>
allow_pivot_root /sys/kernel/security/ /sys/kernel/security/tomoyo/
</pre>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#path_group">path_group</a></li>
</ul>

<h3><a name="use_profile">use_profile</a></h3>

<p>This directive is changes the profile number of the domain.</p>

<p>This example changes the profile number of the domain to 3:</p>

<pre>
use_profile 3
</pre>

<h3><a name="ignore_global_allow_read">ignore_global_allow_read</a></h3>

<p>This directive cancels the effect of <a href="exception-policy-syntax.html.en#allow_read">allow_read</a> directive in the exception policy.</p>

<p>See also:</p>
<ul>
<li><a href="exception-policy-syntax.html.en#allow_read">allow_read</a></li>
</ul>

<h3><a name="quota_exceeded">quota_exceeded</a></h3>

<p>This directive indicates that the domain has failed to append an entry while in "Learning Mode" due to the "max_entry" value being reached.</p>

<h3><a name="transition_failed">transition_failed</a></h3>

<p>This directive indicates that a process within this domain was not able to undergo a domain transition following an execute request.</p>

<p>This problem occurs, in order to avoid access denials by TOMOYO unless enforcing mode is used, due to TOMOYO accepting program execution requests unless enforcing mode even if domain transition has failed. The cause of this problem is either the name of the domain being too long, or the kernel being unable to allocate memory. To fix this problem, either suppress domain transitions or increase the memory quota which TOMOYO can use.</p>

</div><!-- documentation -->

</div><!-- content -->

<div id="navfooter">
<hr>
<table>
<tr>
<td class="docs-previous">
<a href="exception-policy-syntax.html.en">Prev</a>
</td>
<td class="docs-index">
<a href="index.html.en">Index</a>
</td>
<td class="docs-next">
</td>
</tr>
<tr>
<td class="docs-previous-description">
<p>A4: Exception policy syntax</p>
</td>
<td class="docs-home">
<a href="../index.html.en">Main Index</a>
</td>
<td class="docs-next-description">
</td>
</tr>
</table>
</div>

<div id="footer">
<p class="language">Go to <a href="domain-policy-syntax.html.ja">Japanese page</a>.</p>
<p class="timestamp">Last modified: $Date$</p>
<p class="trademark">Linux&reg; is a registered trademark of Linus Torvalds world-wide. TOMOYO&reg; is a registered trademark of <a href="http://www.nttdata.com/global/en/">NTT DATA Corporation</a>.</p>
<p><a href="http://sourceforge.jp/"><img src="http://sourceforge.jp/sflogo.php?group_id=1973" width="96" height="31" alt="sflogo.php" title="SourceForge.jp"></a></p>
</div>

</body>
</html>
