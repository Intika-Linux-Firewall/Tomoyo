<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="ja-JP">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<title>TOMOYO Linuxカーネルの作成手順</title>
<link rel="stylesheet" href="https://tomoyo.osdn.jp/tomoyo.css" media="all" type="text/css">
</head>
<body>
<p>Info: Version <a href="../1.4.1/">1.4.1</a> is available.</p>
<h1>TOMOYO Linuxカーネルの作成手順</h1>
<p style="text-align:right;">Last modified: $Date$</p>

<p>TOMOYO Linux では、いくつかのコンパイル済みのカーネルをパッケージにして提供していますが、アーキテクチャが異なる場合やカスタマイズしたい場合には、カーネルをコンパイルする必要があります。カーネルをコンパイルするためには、以下のパッケージが必要です。</p>

<ul>
<li>gcc</li>
<li>make</li>
<li>ncurses</li>
</ul>

<p>TOMOYO Linux は、必要な機能だけを組み込めるようになっています。 menuconfig の中から、「File systems」を選択して、一番下までスクロールすると以下の項目が表示されます。</p>

<ul>
<li>[*] SAKURA (Domain-Free Mandatory Access Control) support
<li>[*] TOMOYO (Domain-Based Mandatory Access Control) support
<li>&lt;m&gt; SYAORAN (Tamper-Proof Device Filesystem) support
</ul>

<p>以下の機能説明を参照しながら、利用したい機能を選択してください。</p>

<table border="1">
<tr><td>
<h3>ファイルに対する読み書き実行を制限する機能</h3>

<p>プログラムがアクセスできるファイルやディレクトリ等のパス名を「操作対象」単位で制御することができます。</p>

<p>権限の粒度は以下のようになっています。</p>

<table border="1">
<tr><td>権限</td><td>許可されるアクセス</td></tr>
<tr><td>1</td><td>プログラムを実行する</td></tr>
<tr><td>2</td><td>ファイルを書き込みモードで開く</td></tr>
<tr><td>3</td><td>ファイルを書き込みモードで開く／プログラムを実行する</td></tr>
<tr><td>4</td><td>ファイルを読み込みモードで開く</td></tr>
<tr><td>5</td><td>ファイルを読み込みモードで開く／プログラムを実行する</td></tr>
<tr><td>6</td><td>ファイルを読み書きモードで開く</td></tr>
<tr><td>7</td><td>ファイルを読み書きモードで開く／プログラムを実行する</td></tr>
<tr><td>allow_create</td><td>ファイルの新規作成</td></tr>
<tr><td>allow_unlink</td><td>ファイルの削除</td></tr>
<tr><td>allow_mkdir</td><td>ディレクトリの作成</td></tr>
<tr><td>allow_rmdir</td><td>ディレクトリの削除</td></tr>
<tr><td>allow_mkfifo</td><td>FIFO の作成</td></tr>
<tr><td>allow_mksock</td><td>UNIX ドメインソケットの作成</td></tr>
<tr><td>allow_mkblock</td><td>ブロック型デバイスファイルの作成</td></tr>
<tr><td>allow_mkchar</td><td>キャラクタ型デバイスファイルの作成</td></tr>
<tr><td>allow_truncate</td><td>ファイルの切り詰めと伸長</td></tr>
<tr><td>allow_symlink</td><td>シンボリックリンクの作成</td></tr>
<tr><td>allow_link</td><td>ハードリンクの作成</td></tr>
<tr><td>allow_rename</td><td>ファイル名の変更</td></tr>
<tr><td>allow_rewrite</td><td>既に記録されている内容の変更</td></tr>
</table>

<p>この機能を利用するには、以下の項目を選択してください。</p>

<ul>
<li>[*] TOMOYO (Domain-Based Mandatory Access Control) support
<li>[*] &nbsp;&nbsp;File Access Control support
</ul>

<p>なお、この機能は TOMOYO Linux のドメイン遷移を制限するために必須の機能です。この機能を利用しない場合にはドメイン遷移を制限できないので「TOMOYO (Domain-Based Mandatory Access Control) support」が正しく機能しません。</p>

</td></tr><tr><td>

<h3>ケイパビリティの利用を制限する機能</h3>

<p>プログラムが行うことができる操作内容を「操作種別」単位で制御することができます。</p>

<p>標準の Linux で使用されているケイパビリティは POSIX ケイパビリティと呼ばれるものです。最大で３２種類の権限までしか定義できないという制約があるため、特定の権限（特に CAP_SYS_ADMIN 権限）が様々な用途に利用されてしまい、詳細な権限分割を行えないという問題点を抱えています。そのため、 TOMOYO Linux では、 POSIX ケイパビリティには手を加えずに、 TOMOYO Linux 独自の基準で定義したケイパビリティを使用しています。</p>

<p>ケイパビリティの粒度は以下のようになっています。</p>

<table border="1">
<tr><td>ケイパビリティ</td><td>許可される操作内容</td></tr>
<tr><td>inet_tcp_create</td><td>TCP ソケットの使用</td></tr>
<tr><td>inet_tcp_listen</td><td>TCP ソケットの listen</td></tr>
<tr><td>inet_tcp_connect</td><td>TCP ソケットの connect</td></tr>
<tr><td>use_inet_udp</td><td>UDP ソケットの使用</td></tr>
<tr><td>use_inet_ip</td><td>RAW ソケットの使用</td></tr>
<tr><td>use_route</td><td>ROUTE ソケットの使用</td></tr>
<tr><td>use_packet</td><td>PACKET ソケットの使用</td></tr>
<tr><td>use_kernel_module</td><td>カーネルモジュールの使用</td></tr>
<tr><td>create_fifo</td><td>FIFO の作成</td></tr>
<tr><td>create_block_dev</td><td>ブロック型デバイスの作成</td></tr>
<tr><td>create_char_dev</td><td>キャラクタ型デバイスの作成</td></tr>
<tr><td>create_unix_socket</td><td>UNIX ドメインソケットの作成</td></tr>
<tr><td>SYS_MOUNT</td><td>ファイルシステムのマウント</td></tr>
<tr><td>SYS_UMOUNT</td><td>ファイルシステムのアンマウント</td></tr>
<tr><td>SYS_REBOOT</td><td>システムの再起動</td></tr>
<tr><td>SYS_CHROOT</td><td>ルートディレクトリの変更</td></tr>
<tr><td>SYS_KILL</td><td>シグナルの送信</td></tr>
<tr><td>SYS_VHANGUP</td><td>vhangup の使用</td></tr>
<tr><td>SYS_TIME</td><td>システム時刻の変更</td></tr>
<tr><td>SYS_NICE</td><td>プロセスの優先度の変更</td></tr>
<tr><td>SYS_SETHOSTNAME</td><td>ホスト名・ドメイン名の変更</td></tr>
<tr><td>SYS_LINK</td><td>ハードリンクの作成</td></tr>
<tr><td>SYS_SYMLINK</td><td>シンボリックリンクの作成</td></tr>
<tr><td>SYS_RENAME</td><td>ファイル名の変更</td></tr>
<tr><td>SYS_UNLINK</td><td>ファイルの削除</td></tr>
<tr><td>SYS_CHMOD</td><td>ファイルのパーミッションの変更</td></tr>
<tr><td>SYS_CHOWN</td><td>ファイルの所有者・グループの変更</td></tr>
<tr><td>SYS_IOCTL</td><td>ioctl の使用</td></tr>
<tr><td>SYS_KEXEC_LOAD</td><td>新しいカーネルのロード</td></tr>
<tr><td>SYS_PIVOT_ROOT</td><td>ルートディレクトリの交換</td></tr>
</table>

<p>この機能を利用するには、以下の項目を選択してください。</p>

<ul>
<li>[*] TOMOYO (Domain-Based Mandatory Access Control) support
<li>[*] &nbsp;&nbsp;Capability Control support
</ul>

</td></tr><tr><td>

<h3>TCP/IP ネットワークの利用を制限する機能</h3>

<p>プログラムが使用できるアドレスとポートを制限することができます。</p>

<p>例えば、 DNS サーバの IP アドレスとポート 53 への UDP 通信だけを許可したい場合や、 SSH サーバが接続を受け付けるクライアントの IP アドレスの範囲を制限したいときに使用します。</p>

<p>この機能を利用するには、以下の項目を選択してください。</p>

<ul>
<li>[*] TOMOYO (Domain-Based Mandatory Access Control) support
<li>[*] &nbsp;&nbsp;Network Address Port Control support
</ul>

</td></tr><tr><td>

<h3>シグナルの種類と送信先の組み合わせを制限する機能</h3>

<p>プログラムが使用できるシグナルの種類と送信先を制限することができます。</p>

<p>この機能は、攻撃者が任意のプロセスに対してシグナルを送ることで任意のサービスを強制終了させてしまうのを防ぎたいときに使用します。</p>

<p>この機能を利用するには、以下の項目を選択してください。</p>

<ul>
<li>[*] TOMOYO (Domain-Based Mandatory Access Control) support
<li>[*] &nbsp;&nbsp;Signal Control support
</ul>

</td></tr><tr><td>

<h3>シグナルの種類と送信先の組み合わせを制限する機能</h3>

<p>プログラムが使用できるシグナルの種類と送信先を制限することができます。</p>

<p>この機能は、攻撃者が任意のプロセスに対してシグナルを送ることで任意のサービスを強制終了させてしまうのを防ぎたいときに使用します。</p>

<p>この機能を利用するには、以下の項目を選択してください。</p>

<ul>
<li>[*] TOMOYO (Domain-Based Mandatory Access Control) support
<li>[*] &nbsp;&nbsp;Signal Control support
</ul>

</td></tr><tr><td>

<h3>プログラム実行時に渡される名前を制限する機能</h3>

<p>プログラム実行時に渡される名前を制限することができます。</p>

<p>プログラムを実行するときには、プログラム名とそのプログラムへの引数が argv[] という文字列型配列で渡されます。最初の要素である argv[0] にはプログラム名が入っています。<br>
一部のプログラムは、 argv[0] の内容に基づいて振る舞いを変化させます。そのようなプログラムでは、ドメイン遷移がプログラムファイルのパス名に基づいて行われるのに対し、実際の振る舞いは argv[0] の内容に基づいて決定されます。<br>
そのため、攻撃者はファイルのパス名と argv[0] の内容を故意に異なるものにすることで、想定外の動作を行わせることができてしまいます。この機能を利用すると、ファイルのパス名と argv[0] の内容が異なる場合に、ポリシーで許可された組み合わせの場合のみ実行を許可することができます。</p>

<p>この機能を利用するには、以下の項目を選択してください。</p>

<ul>
<li>[*] TOMOYO (Domain-Based Mandatory Access Control) support
<li>[*] &nbsp;&nbsp;argv[0] checker support
</ul>

</td></tr><tr><td>

<h3>マウント可能な「デバイスファイルとマウントポイントとファイルシステム」の組み合わせの制限および「特定のマウントオプション」を強制的に適用する機能</h3>

<p>Linux では、システム管理者権限があれば任意のディレクトリに任意のファイルシステムをマウントすることが可能です。つまり、システム管理者権限で動作しているプロセスの制御を奪われた場合、 /bin/ ディレクトリの上に tmpfs を被せて悪意あるプログラムに置き換えられたり、 /var/www/ ディレクトリの上に tmpfs を被せて WWW コンテンツを隠蔽されたりすることがあるわけです。</p>

<p>ケイパビリティを使えばマウント操作を行えるドメインを制限することができますが、権限が与えられさえすれば任意のマウント操作ができてしまい、望ましくありません。</p>

<p>この機能を利用すると、マウントを許可する組合せを制限することができます。</p>

<p>また、この機能には、特定のマウントオプションの適用を強制する機能も含まれています。
例えば、「 /tmp/ パーティションではデバイスファイルにアクセスさせないために nodev オプションを強制したい」という場合に利用すると、利用者が dev オプションを指定しても nodev オプションが適用された状態でマウントされます。</p>

<p>この機能を利用するには、以下の項目を選択してください。</p>

<ul>
<li>[*] SAKURA (Domain-Free Mandatory Access Control) support
<li>[*] &nbsp;&nbsp;mount() restriction support
</ul>

</td></tr><tr><td>

<h3>特定のマウントポイントのアンマウントを禁止する機能</h3>

<p>Linux では、システム管理者権限があれば任意のマウントポイントをアンマウントすることが可能です。つまり、システム管理者権限で動作しているプロセスの制御を奪われた場合、 /proc/ ディレクトリにマウントされている proc ファイルシステムをアンマウントすることでアプリケーションの動作を狂わせたりすることがあるわけです。</p>

<p>ケイパビリティを使えばアンマウント操作を行えるドメインを制限することができますが、権限が与えられさえすれば任意のアンマウント操作ができてしまい、望ましくありません。</p>

<p>この機能を利用すると、特定のマウントポイントがアンマウントされることを禁止することができます。</p>

<p>この機能を利用するには、以下の項目を選択してください。</p>

<ul>
<li>[*] SAKURA (Domain-Free Mandatory Access Control) support
<li>[*] &nbsp;&nbsp;umount() restriction support
</ul>

</td></tr><tr><td>

<h3>マウント済みのマウントポイントを隠蔽するようなマウント要求を拒否する機能</h3>

<p>Linux では、システム管理者権限があれば既にマウントされているマウントポイントの上に他のパーティションを重ねてマウントすることが可能です。つまり、システム管理者権限で動作しているプロセスの制御を奪われた場合、既にマウントされている /var/ パーティションの上に tmpfs をマウントすることでアプリケーションの動作を狂わせたりすることがあるわけです。</p>

<p>ケイパビリティを使えばマウント操作を行えるドメインを制限することができますが、権限が与えられさえすれば任意のマウント操作ができてしまい、望ましくありません。</p>

<p>この機能を利用すると、マウント済みのマウントポイントを隠蔽するようなマウント要求を拒否することができます。</p>

<p>この機能を利用するには、以下の項目を選択してください。</p>

<ul>
<li>[*] SAKURA (Domain-Free Mandatory Access Control) support
<li>[*] &nbsp;&nbsp;Conceal mount disabler support
</ul>

</td></tr><tr><td>

<h3>chroot で移動可能なディレクトリを制限する機能</h3>

<p>Linux では、システム管理者権限があれば任意のディレクトリに chroot で移動することが可能です。つまり、システム管理者権限で動作しているプロセスの制御を奪われた場合、意味のないディレクトリへ chroot で移動することでアプリケーションの動作を妨害されてしまうことがあるわけです。</p>

<p>ケイパビリティを使えば chroot を行えるドメインを制限することができますが、権限が与えられさえすれば任意のディレクトリへ chroot ができてしまい、望ましくありません。</p>

<p>この機能を利用すると、 chroot で移動することを許可するディレクトリを制限することができます。</p>

<p>この機能を利用するには、以下の項目を選択してください。</p>

<ul>
<li>[*] SAKURA (Domain-Free Mandatory Access Control) support
<li>[*] &nbsp;&nbsp;chroot() restriction support
</ul>

</td></tr><tr><td>

<h3>pivot_root で交換可能なディレクトリを制限する機能</h3>

<p>chroot は / ディレクトリを移動するのに対し、 pivot_root は / ディレクトリを交換します。システムの起動時に１度だけ使われる場合が多いですが、システムの起動後は通常は使われない機能です。</p>

<p>この機能を利用すると、 pivot_root で交換することを許可するディレクトリを制限することができます。</p>

<p>この機能を利用するには、以下の項目を選択してください。</p>

<ul>
<li>[*] SAKURA (Domain-Free Mandatory Access Control) support
<li>[*] &nbsp;&nbsp;pivot_root() restriction support
</ul>

</td></tr><tr><td>

<h3>TCP/IP ネットワークで自動的に割り当てられるローカルポートを制限する機能</h3>

<p>Linux では、ポート番号として 0 を指定して bind() を呼び出した場合や、 bind() を呼び出さずに connect() を呼び出した場合などに、 /proc/sys/net/ipv4/ip_local_port_range というファイルで指定されている範囲の中から未使用のローカルポート番号が自動的に割り当てられます。しかし、このファイルで指定可能な値は最小値と最大値のみであり、特定のポート番号を除外する機能はありません。</p>

<p>例えば、ポート 8080 をプロキシサーバ用に予約しておきたい場合でも、このファイルに 1024 65535 という値が書き込まれているとポート 8080 が自動割り当てによって他のアプリケーションに割り当てられてしまい、プロキシサーバを起動しようとしたらポートが既に使用中であるために起動できないという場合が生じてしまいます。また、クライアントがサーバのポート 8080 に接続してみたら、プロキシサーバ以外のアプリケーションに繋がってしまったという場合も生じてしまいます。</p>

<p>この機能を利用すると、特定のポート番号を自動割り当ての対象から除外（つまり /proc/sys/net/ipv4/ip_local_port_range に複数の範囲を指定できるようにするのと同じ機能を提供）することができます。</p>

<p>この機能を利用するには、以下の項目を選択してください。</p>

<ul>
<li>[*] SAKURA (Domain-Free Mandatory Access Control) support
<li>[*] &nbsp;&nbsp;Autobind restriction support
</ul>

</td></tr><tr><td>

<h3>デバイスファイルの改ざんを防止できる /dev ディレクトリ用のファイルシステム</h3>

<p> /dev ディレクトリには多数のデバイスファイルが存在しています。そして、デバイスファイルが常に正しいデバイスと繋がっていることは、セキュリティ上、不可欠です。 例えば、 /dev/null がメジャー番号 1 マイナー番号 3 のキャラクタ型デバイスとしてではなく、メジャー番号 8 マイナー番号 0 のブロック型デバイス（ /dev/sda ）として存在していた場合、たちまち SCSI ハードディスクの内容が破壊されてしまいます。また、 /dev/null が通常ファイルとして存在していた場合、情報漏えいに繋がる可能性があります。</p>

<p>そこで、デバイスファイルの名前とその属性との対応を強制することができる SYAORAN ファイルシステムを /dev ディレクトリにマウントすることにより、例えば、 /dev/null は常にメジャー番号 1 マイナー番号 3 のキャラクタ型デバイスであることを保証することができます。</p>

<p>この機能を利用するには、以下の項目を選択してください。</p>

<ul>
<li>&lt;m&gt; SYAORAN (Tamper-Proof Device Filesystem) support
</ul>

<p>udev を使用するディストリビューションの場合、 udev が自動的に /dev ディレクトリに tmpfs をマウントしてしまうため、 SYAORAN ファイルシステムが隠蔽されてしまいます。これを防ぐために、 udev を使用するディストリビューションで使用する場合は、以下の項目も選択してください。</p>

<ul>
<li>[*] SAKURA (Domain-Free Mandatory Access Control) support
<li>[*] &nbsp;&nbsp;Conceal mount disabler support
</ul>

</td></tr>
</table>

<p>カーネル 2.6 には、 CONFIG_DEBUG_INFO という名前のコンパイルオプションが存在します。このオプションが有効である場合、コンパイルされたコードのサイズが約１０倍の大きさになります。このオプションを有効にすると、 /usr/src/ ディレクトリで約１ＧＢ、 /lib/modules/ ディレクトリで約３００ＭＢの余分なディスク領域を消費します。<br>
ディスク領域を節約したい場合、以下のオプションを無効にしてください。</p>

<table border="1">
<tr><td>
Kernel hacking ---&gt;[&nbsp;] &nbsp;&nbsp;Compile the kernel with debug info
</td></tr>
</table>

<p>以下の一覧から、該当するバージョンを選択してください。</p>

<ul>
<li><a href="#2.4.20-46.9.legacy">RedHat Linux 9 用のカーネル 2.4.20-46.9.legacy</a>
<li><a href="#2.6.12-2.3.legacy_FC3">Fedora Core 3 用のカーネル 2.6.12-2.3.legacy_FC3</a>
<li><a href="#2.6.17-1.2142_FC4">Fedora Core 4 用のカーネル 2.6.17-1.2142_FC4</a>
<li><a href="#2.6.20-1.2316.fc5">Fedora Core 5 用のカーネル 2.6.20-1.2316.fc5</a>
<li><a href="#2.6.20-1.2952.fc6">Fedora Core 6 用のカーネル 2.6.20-1.2952.fc6</a>
<li><a href="#2.6.21-1.3194.fc7">Fedora 7 用のカーネル 2.6.21-1.3194.fc7</a>
<li><a href="#2.6.9-55.EL">CentOS 4.5 用のカーネル 2.6.9-55.EL</a>
<li><a href="#2.6.18-8.1.4.el5">CentOS 5 用のカーネル 2.6.18-8.1.4.el5</a>
<li><a href="#2.4.27-10sarge5">Debian Sarge 用のカーネル 2.4.27-10sarge5</a>
<li><a href="#2.6.8-16sarge6">Debian Sarge 用のカーネル 2.6.8-16sarge6</a>
<li><a href="#2.6.18-12etch2">Debian Etch 用のカーネル 2.6.18-12etch2</a>
<li><a href="#2.6.16.27-0.9">OpenSUSE 10.1 用のカーネル 2.6.16.27-0.9</a>
<li><a href="#2.6.18.8-0.3">OpenSUSE 10.2 用のカーネル 2.6.18.8-0.3</a>
<li><a href="#2.6.9-42.13AX">Asianux 2.0 用のカーネル 2.6.9-42.13AX</a>
<li><a href="#2.6.17.14-ubuntu1">Ubuntu 6.10 用のカーネル 2.6.17.14-ubuntu1</a>
<li><a href="#2.6.20.3-ubuntu1">Ubuntu 7.04 用のカーネル 2.6.20.3-ubuntu1</a>
<li><a href="#2.6.16-0vl73">VineLinux 4.1 用のカーネル 2.6.16-0vl73</a>
<li><a href="#2.6-vanilla">バニラ 2.6 カーネル</a>
<li><a href="#2.4-vanilla">バニラ 2.4 カーネル</a>
</ul>

<hr>

<h2><a name="2.4.20-46.9.legacy">RedHat Linux 9 用のカーネル 2.4.20-46.9.legacy</a></h2>

<table border="1">
<tr><td>
# カーネルのソースをダウンロードしてインストールする。<br>
wget http://ftp.riken.go.jp/Linux/fedoralegacy/redhat/9/updates/i386/kernel-source-2.4.20-46.9.legacy.i386.rpm<br>
rpm -ivh kernel-source-2.4.20-46.9.legacy.i386.rpm<br>
# ソースのディレクトリへ移動する。<br>
cd /usr/src/linux-2.4.20-46.9.legacy/<br>
# TOMOYO Linux パッチをダウンロードして適用する。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
patch -sp1 &lt; ccs-patch-2.4.20-46.9.legacy.txt<br>
# カーネルコンフィグ以外の一時ファイルを削除する。<br>
mv .config config<br>
make -s distclean<br>
mv config .config<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s dep modules modules_install install
</td></tr>
</table>

<h2><a name="2.6.12-2.3.legacy_FC3">Fedora Core 3 用のカーネル 2.6.12-2.3.legacy_FC3</a></h2>

<table border="1">
<tr><td>
# カーネルのソースをダウンロードしてインストールする。<br>
wget http://ftp.riken.go.jp/Linux/fedoralegacy/fedora/3/updates/SRPMS/kernel-2.6.12-2.3.legacy_FC3.src.rpm<br>
rpm -ivh kernel-2.6.12-2.3.legacy_FC3.src.rpm<br>
# コンパイルの準備をする。<br>
rpmbuild -bp --target i586 /usr/src/redhat/SPECS/kernel-2.6.spec<br>
mv /usr/src/redhat/BUILD/kernel-2.6.12/linux-2.6.12/ /usr/src/linux-2.6.12-2.3.legacy_FC3<br>
# ソースのディレクトリへ移動する。<br>
cd /usr/src/linux-2.6.12-2.3.legacy_FC3/<br>
# バージョン番号を修正する。<br>
sed -i 's/EXTRAVERSION = -prep/EXTRAVERSION = -2.3.legacy_FC3/' Makefile<br>
# TOMOYO Linux パッチをダウンロードして適用する。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
patch -sp1 &lt; ccs-patch-2.6.12-2.3.legacy_FC3.txt<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s modules modules_install install
</td></tr>
</table>

<h2><a name="2.6.17-1.2142_FC4">Fedora Core 4 用のカーネル 2.6.17-1.2142_FC4</a></h2>

<table border="1">
<tr><td>
# カーネルのソースをダウンロードしてインストールする。<br>
wget http://download.fedora.redhat.com/pub/fedora/linux/core/updates/4/SRPMS/kernel-2.6.17-1.2142_FC4.src.rpm<br>
rpm -ivh kernel-2.6.17-1.2142_FC4.src.rpm<br>
# コンパイルの準備をする。<br>
rpmbuild -bp --target i586 /usr/src/redhat/SPECS/kernel-2.6.spec<br>
mv /usr/src/redhat/BUILD/kernel-2.6.17/linux-2.6.17/ /usr/src/linux-2.6.17-1.2142_FC4<br>
# ソースのディレクトリへ移動する。<br>
cd /usr/src/linux-2.6.17-1.2142_FC4/<br>
# バージョン番号を修正する。<br>
sed -i 's/EXTRAVERSION = -prep/EXTRAVERSION = -1.2142_FC4/' Makefile<br>
# TOMOYO Linux パッチをダウンロードして適用する。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
patch -sp1 &lt; ccs-patch-2.6.17-1.2142_FC4.txt<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s<br>
make -s modules modules_install install
</td></tr>
</table>

<h2><a name="2.6.20-1.2316.fc5">Fedora Core 5 用のカーネル 2.6.20-1.2316.fc5</a></h2>

<table border="1">
<tr><td>
# カーネルのソースをダウンロードしてインストールする。<br>
wget http://download.fedora.redhat.com/pub/fedora/linux/core/updates/5/SRPMS/kernel-2.6.20-1.2316.fc5.src.rpm<br>
rpm -ivh kernel-2.6.20-1.2316.fc5.src.rpm<br>
# コンパイルの準備をする。<br>
rpmbuild -bp --target i586 /usr/src/redhat/SPECS/kernel-2.6.spec<br>
mv /usr/src/redhat/BUILD/kernel-2.6.20/linux-2.6.20.i586/ /usr/src/linux-2.6.20-1.2316.fc5<br>
# ソースのディレクトリへ移動する。<br>
cd /usr/src/linux-2.6.20-1.2316.fc5/<br>
# バージョン番号を修正する。<br>
sed -i 's/EXTRAVERSION = -prep/EXTRAVERSION = -1.2316.fc5/' Makefile<br>
# TOMOYO Linux パッチをダウンロードして適用する。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
patch -sp1 &lt; ccs-patch-2.6.20-1.2316.fc5.txt<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s<br>
make -s modules modules_install install
</td></tr>
</table>

<h2><a name="2.6.20-1.2952.fc6">Fedora Core 6 用のカーネル 2.6.20-1.2952.fc6</a></h2>

<table border="1">
<tr><td>
# カーネルのソースをダウンロードしてインストールする。<br>
wget http://download.fedora.redhat.com/pub/fedora/linux/core/updates/6/SRPMS/kernel-2.6.20-1.2952.fc6.src.rpm<br>
rpm -ivh kernel-2.6.20-1.2952.fc6.src.rpm<br>
# コンパイルの準備をする。<br>
rpmbuild -bp --target i586 /usr/src/redhat/SPECS/kernel-2.6.spec<br>
mv /usr/src/redhat/BUILD/kernel-2.6.20/linux-2.6.20.i586/ /usr/src/linux-2.6.20-1.2952.fc6<br>
# ソースのディレクトリへ移動する。<br>
cd /usr/src/linux-2.6.20-1.2952.fc6/<br>
# バージョン番号を修正する。<br>
sed -i 's/EXTRAVERSION = -prep/EXTRAVERSION = -1.2952.fc6/' Makefile<br>
# TOMOYO Linux パッチをダウンロードして適用する。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
wget -O ccs-patch-2.6.20-1.2952.fc6.txt 'https://osdn.jp/tracker/download.php?group_id=1973&amp;atid=7342&amp;file_id=1910&amp;aid=10415'<br>
patch -sp1 &lt; ccs-patch-2.6.20-1.2952.fc6.txt<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s<br>
make -s modules modules_install install
</td></tr>
</table>

<h2><a name="2.6.21-1.3194.fc7">Fedora 7 用のカーネル 2.6.21-1.3194.fc7</a></h2>

<table border="1">
<tr><td>
# カーネルのソースをダウンロードしてインストールする。<br>
wget http://download.fedora.redhat.com/pub/fedora/linux/core/development/source/SRPMS/kernel-2.6.21-1.3194.fc7.src.rpm<br>
rpm -ivh kernel-2.6.21-1.3194.fc7.src.rpm<br>
# コンパイルの準備をする。<br>
rpmbuild -bp --target i586 /usr/src/redhat/SPECS/kernel-2.6.spec<br>
mv /usr/src/redhat/BUILD/kernel-2.6.21/linux-2.6.21.i586/ /usr/src/linux-2.6.21-1.3194.fc7<br>
# ソースのディレクトリへ移動する。<br>
cd /usr/src/linux-2.6.21-1.3194.fc7/<br>
# バージョン番号を修正する。<br>
sed -i 's/EXTRAVERSION = -prep/EXTRAVERSION = -1.3194.fc7/' Makefile<br>
# TOMOYO Linux パッチをダウンロードして適用する。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
wget -O ccs-patch-2.6.21-1.3194.fc7.txt 'https://osdn.jp/tracker/download.php?group_id=1973&amp;atid=7342&amp;file_id=1918&amp;aid=10415'<br>
patch -sp1 &lt; ccs-patch-2.6.21-1.3194.fc7.txt<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s<br>
make -s modules modules_install install
</td></tr>
</table>

<h2><a name="2.6.9-55.EL">CentOS 4.5 用のカーネル 2.6.9-55.EL</a></h2>

<table border="1">
<tr><td>
# カーネルのソースをダウンロードしてインストールする。<br>
wget http://mirrors.kernel.org/centos/4.5/os/SRPMS/kernel-2.6.9-55.EL.src.rpm<br>
rpm -ivh kernel-2.6.9-55.EL.src.rpm<br>
# コンパイルの準備をする。<br>
rpmbuild -bp --target i586 /usr/src/redhat/SPECS/kernel-2.6.spec<br>
mv /usr/src/redhat/BUILD/kernel-2.6.9/linux-2.6.9/ /usr/src/linux-2.6.9-55.EL<br>
# ソースのディレクトリへ移動する。<br>
cd /usr/src/linux-2.6.9-55.EL/<br>
# バージョン番号を修正する。<br>
sed -i 's/EXTRAVERSION = -prep/EXTRAVERSION = -55.EL/' Makefile<br>
# TOMOYO Linux パッチをダウンロードして適用する。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
wget -O ccs-patch-2.6.9-55.EL.txt 'https://osdn.jp/tracker/download.php?group_id=1973&amp;atid=7342&amp;file_id=1872&amp;aid=10415'<br>
patch -sp1 &lt; ccs-patch-2.6.9-55.EL.txt<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s<br>
make -s modules modules_install install
</td></tr>
</table>

<h2><a name="2.6.18-8.1.4.el5">CentOS 5 用のカーネル 2.6.18-8.1.4.el5</a></h2>

<table border="1">
<tr><td>
# カーネルのソースをダウンロードしてインストールする。<br>
wget http://mirrors.kernel.org/centos/5.0/updates/SRPMS/kernel-2.6.18-8.1.4.el5.src.rpm<br>
rpm -ivh kernel-2.6.18-8.1.4.el5.src.rpm<br>
# コンパイルの準備をする。<br>
rpmbuild -bp --target i686 /usr/src/redhat/SPECS/kernel-2.6.spec<br>
mv /usr/src/redhat/BUILD/kernel-2.6.18/linux-2.6.18.i686/ /usr/src/linux-2.6.18-8.1.4.el5<br>
# ソースのディレクトリへ移動する。<br>
cd /usr/src/2.6.18-8.1.4.el5/<br>
# バージョン番号を修正する。<br>
sed -i 's/EXTRAVERSION = -prep/EXTRAVERSION = -8.1.4.el5/' Makefile<br>
# TOMOYO Linux パッチをダウンロードして適用する。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
wget -O ccs-patch-2.6.18-8.1.4.el5.txt 'https://osdn.jp/tracker/download.php?group_id=1973&amp;atid=7342&amp;file_id=1874&amp;aid=10415'<br>
patch -sp1 &lt; ccs-patch-2.6.18-8.1.4.el5.txt<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s<br>
make -s modules modules_install install
</td></tr>
</table>

<h2><a name="2.4.27-10sarge5">Debian Sarge 用のカーネル 2.4.27-10sarge5</a></h2>

<table border="1">
<tr><td>
# カーネルのソースをダウンロードしてインストールする。<br>
apt-get install kernel-source-2.4.27<br>
tar -jxf /usr/src/kernel-source-2.4.27.tar.bz2<br>
# ソースのディレクトリへ移動する。<br>
cd kernel-source-2.4.27/<br>
# TOMOYO Linux パッチをダウンロードして適用する。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
patch -sp1 &lt; ccs-patch-2.4.27-10sarge5.txt<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s dep install modules modules_install<br>
# initrd を作成する。<br>
mkinitrd -o /boot/initrd.img-2.4.27-10sarge5-ccs 2.4.27-10sarge5-ccs
</td></tr>
</table>

<h2><a name="2.6.8-16sarge6">Debian Sarge 用のカーネル 2.6.8-16sarge6</a></h2>

<table border="1">
<tr><td>
# カーネルのソースをダウンロードしてインストールする。<br>
apt-get install kernel-source-2.6.8<br>
tar -jxf /usr/src/kernel-source-2.6.8.tar.bz2<br>
# ソースのディレクトリへ移動する。<br>
cd kernel-source-2.6.8/<br>
# TOMOYO Linux パッチをダウンロードして適用する。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
patch -sp1 &lt; ccs-patch-2.6.8-16sarge6.txt<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s<br>
make -s install modules modules_install<br>
# initrd を作成する。<br>
mkinitrd -o /boot/initrd.img-2.6.8-16sarge6-ccs 2.6.8-16sarge6-ccs
</td></tr>
</table>

<h2><a name="2.6.18-12etch2">Debian Etch 用のカーネル 2.6.18-12etch2</a></h2>

<table border="1">
<tr><td>
# カーネルのソースをダウンロードしてインストールする。<br>
apt-get install linux-source-2.6.18<br>
tar -jxf /usr/src/linux-source-2.6.18.tar.bz2<br>
# ソースのディレクトリへ移動する。<br>
cd linux-source-2.6.18/<br>
# TOMOYO Linux パッチをダウンロードして適用する。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
patch -sp1 &lt; ccs-patch-2.6.18-12etch2.txt<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s<br>
make -s install modules modules_install<br>
# initrd を作成する。<br>
mkinitrd -o /boot/initrd.img-2.6.18-ccs 2.6.18-ccs
</td></tr>
</table>

<h2><a name="2.6.16.27-0.9">OpenSUSE 10.1 用のカーネル 2.6.16.27-0.9</a></h2>

<table border="1">
<tr><td>
# カーネルのソースをダウンロードしてインストールする。<br>
wget http://ftp.novell.co.jp/pub/suse/suse/update/10.1/rpm/i586/kernel-source-2.6.16.27-0.9.i586.rpm<br>
rpm -ivh kernel-source-2.6.16.27-0.9.i586.rpm<br>
# ソースのディレクトリへ移動する。<br>
cd /usr/src/linux-2.6.16.27-0.9/<br>
# TOMOYO Linux パッチをダウンロードして適用する。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
patch -sp1 &lt; ccs-patch-2.6.16.27-0.9_SUSE.txt<br>
# 出力先のディレクトリへ移動する。<br>
cd /usr/src/linux-2.6.16.27-0.9-obj/i386/default/<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s<br>
make -s modules modules_install install
</td></tr>
</table>

<h2><a name="2.6.18.8-0.3">OpenSUSE 10.2 用のカーネル 2.6.18.8-0.3</a></h2>

<table border="1">
<tr><td>
# カーネルのソースをダウンロードしてインストールする。<br>
wget http://ftp.novell.co.jp/pub/suse/suse/update/10.2/rpm/i586/kernel-source-2.6.18.8-0.3.i586.rpm<br>
rpm -ivh kernel-source-2.6.18.8-0.3.i586.rpm<br>
# ソースのディレクトリへ移動する。<br>
cd /usr/src/linux-2.6.18.8-0.3/<br>
# TOMOYO Linux パッチをダウンロードして適用する。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
patch -sp1 &lt; ccs-patch-2.6.18.8-0.3_SUSE.txt<br>
# 出力先のディレクトリへ移動する。<br>
cd /usr/src/linux-2.6.18.8-0.3-obj/i386/default/<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s<br>
make -s modules modules_install install
</td></tr>
</table>

<h2><a name="2.6.9-42.13AX">Asianux 2.0 用のカーネル 2.6.9-42.13AX</a></h2>

<table border="1">
<tr><td>
# カーネルのソースをダウンロードしてインストールする。<br>
wget http://ftp.miraclelinux.com/pub/Miracle/ia32/standard/4.0/updates/SRPMS/kernel-2.6.9-42.13AX.src.rpm<br>
rpm -ivh kernel-2.6.9-42.13AX.src.rpm<br>
# コンパイルの準備をする。<br>
rpmbuild -bp --target i686 /usr/src/asianux/SPECS/kernel-2.6.spec<br>
mv /usr/src/asianux/BUILD/kernel-2.6.9/linux-2.6.9/ /usr/src/linux-2.6.9-42.13AX<br>
# ソースのディレクトリへ移動する。<br>
cd /usr/src/linux-2.6.9-42.13AX/<br>
# バージョン番号を修正する。<br>
sed -i 's/EXTRAVERSION = -prep/EXTRAVERSION = -42.13AX/' Makefile<br>
# TOMOYO Linux パッチをダウンロードして適用する。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
wget -O ccs-patch-2.6.9-42.13AX.txt 'https://osdn.jp/tracker/download.php?group_id=1973&amp;atid=7342&amp;file_id=1885&amp;aid=10415'<br>
patch -sp1 &lt; ccs-patch-2.6.9-42.13AX.txt<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s<br>
make -s modules modules_install install
</td></tr>
</table>

<h2><a name="2.6.17.14-ubuntu1">Ubuntu 6.10 用のカーネル 2.6.17.14-ubuntu1</a></h2>

<table border="1">
<tr><td>
# カーネルのソースをダウンロードしてインストールする。<br>
apt-get install linux-source-2.6.17<br>
tar -jxf /usr/src/linux-source-2.6.17.tar.bz2<br>
# ソースのディレクトリへ移動する。<br>
cd linux-source-2.6.17/<br>
# TOMOYO Linux パッチをダウンロードして適用する。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
patch -sp1 &lt; ccs-patch-2.6.17.14-ubuntu1.txt<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s<br>
make -s install modules modules_install<br>
# initramfs を作成する。<br>
mkinitramfs -o /boot/initrd.img-2.6.17.14-ubuntu1-ccs 2.6.17.14-ubuntu1-ccs
</td></tr>
</table>

<h2><a name="2.6.20.3-ubuntu1">Ubuntu 7.04 用のカーネル 2.6.20.3-ubuntu1</a></h2>

<table border="1">
<tr><td>
# カーネルのソースをダウンロードしてインストールする。<br>
apt-get install linux-source-2.6.20<br>
tar -jxf /usr/src/linux-source-2.6.20.tar.bz2<br>
# ソースのディレクトリへ移動する。<br>
cd linux-source-2.6.20/<br>
# TOMOYO Linux パッチをダウンロードして適用する。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
patch -sp1 &lt; ccs-patch-2.6.20.3-ubuntu1.txt<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s<br>
make -s install modules modules_install<br>
# initramfs を作成する。<br>
mkinitramfs -o /boot/initrd.img-2.6.20.3-ubuntu1-ccs 2.6.20.3-ubuntu1-ccs
</td></tr>
</table>

<h2><a name="2.6.16-0vl73">VineLinux 4.1 用のカーネル 2.6.16-0vl73</a></h2>

<table border="1">
<tr><td>
# make install 時にエラーが出ないようにするための細工をする。<br>
ln -s /bin/true /sbin/lilo<br>
# カーネルのソースをダウンロードしてインストールする。<br>
apt-get install kernel-source<br>
# ソースのディレクトリへ移動する。<br>
cd /usr/src/linux-2.6.16/<br>
# TOMOYO Linux パッチをダウンロードして適用する。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
patch -sp1 &lt; ccs-patch-2.6.16-0vl73.txt<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s<br>
make -s modules modules_install install<br>
# initrd を作成する。<br>
mkinitrd /boot/initrd.img-2.6.16-0vl73-ccs 2.6.16-0vl73-ccs<br>
# シンボリックリンクを更新する。<br>
ln -sf /boot/vmlinuz-2.6.16-0vl73-ccs /boot/vmlinuz<br>
ln -sf /boot/initrd.img-2.6.16-0vl73-ccs /boot/initrd.img<br>
ln -sf /boot/System.map-2.6.16-0vl73-ccs /boot/System.map
</td></tr>
</table>

<h2><a name="2.6-vanilla">バニラ 2.6 カーネル</a></h2>

<p>2.6.11 以降に対応しています。以下の手順では 2.6.21 を使用するものとします。</p>

<table border="1">
<tr><td>
# カーネルモジュールをインストールするディレクトリを作成する。<br>
mkdir -p /lib/modules/2.6.21-ccs<br>
# ソースディレクトリへ移動する。<br>
cd /usr/src/<br>
# カーネルのソースをダウンロードする。<br>
wget https://www.kernel.org/pub/linux/kernel/v2.6/linux-2.6.21.tar.bz2<br>
# 展開する。<br>
tar -jxf linux-2.6.21.tar.bz2<br>
# 展開されたソースのディレクトリへ移動する。<br>
cd linux-2.6.21<br>
# ソースから world writable 属性を取り除く。<br>
find -print0 | xargs -0 chmod go-w --<br>
# TOMOYO Linux カーネルパッチをダウンロードする。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
# 展開する。<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
# カーネルパッチを適用する。<br>
patch -sp1 &lt; ccs-patch-2.6.21.txt<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s<br>
make -s install modules modules_install
</td></tr>
</table>

<h2><a name="2.4-vanilla">バニラ 2.4 カーネル</a></h2>

<p>2.4.30 以降に対応しています。以下の手順では 2.4.34 を使用するものとします。</p>

<table border="1">
<tr><td>
# カーネルモジュールをインストールするディレクトリを作成する。<br>
mkdir -p /lib/modules/2.4.34-ccs<br>
# ソースディレクトリへ移動する。<br>
cd /usr/src/<br>
# カーネルのソースをダウンロードする。<br>
wget https://www.kernel.org/pub/linux/kernel/v2.4/linux-2.4.34.tar.bz2<br>
# 展開する。<br>
tar -jxf linux-2.4.34.tar.bz2<br>
# 展開されたソースのディレクトリへ移動する。<br>
cd linux-2.4.34<br>
# ソースから world writable 属性を取り除く。<br>
find -print0 | xargs -0 chmod go-w --<br>
# TOMOYO Linux カーネルパッチをダウンロードする。<br>
wget -O ccs-patch-1.4-20070518.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/24614/ccs-patch-1.4-20070518.tar.gz'<br>
# 展開する。<br>
tar -zxf ccs-patch-1.4-20070518.tar.gz<br>
# カーネルパッチを適用する。<br>
patch -sp1 &lt; ccs-patch-2.4.34.txt<br>
# TOMOYO Linux 用のオプションを選択する。<br>
make -s menuconfig<br>
# 通常通りコンパイルする。<br>
make -s dep<br>
make -s<br>
make -s modules modules_install install
</td></tr>
</table>
<p><a href="https://osdn.jp/"><img src="https://osdn.jp/sflogo.php?group_id=1973" width="96" height="31" alt="sflogo.php" title="SourceForge.jp"></a></p>
</body>
</html>
