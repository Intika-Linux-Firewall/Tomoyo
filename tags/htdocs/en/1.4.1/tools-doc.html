<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<meta http-equiv="Content-Style-Type" content="text/css">
<title>Tools Documentation</title>
<link rel="stylesheet" href="tomoyo.css" media="all" type="text/css">
</head>
<body>
<p>Info: Version <a href="../1.4.x/">1.4.x</a> is available.</p>
<h1>Tools Documentation</h1>
<p style="text-align:right;">Last modified: $Date$</p>
<hr>
<h2><a name="administration_tool">&lt;&lt;Tools for system administrators&gt;&gt;</a></h2>

<h3><a name="editpolicy">&lt;Policy Editor "editpolicy"&gt;</a></h3>
<p>Edits the current policy in /proc/ccs/policy/ directory.</p>
<p>You may give one of "s" "e" "d" to the commandline to choose the initial screen. If not given, screen for domain listing is shown.</p>

<p>&lt;Scroll&gt;</p>
<table border="1">
<tr><td>Up-arrow</td><td>Scroll 1 line up.</td></tr>
<tr><td>Down-arrow</td><td>Scroll 1 line down.</td></tr>
<tr><td>PageUp</td><td>Scroll 1 page up.</td></tr>
<tr><td>PageDown</td><td>Scroll 1 page down.</td></tr>
<tr><td>Right-arrow</td><td>Scroll 1 column right.</td></tr>
<tr><td>Left-arrow</td><td>Scroll 1 column left.</td></tr>
<tr><td>Home</td><td>Move to the top of line.</td></tr>
<tr><td>End</td><td>Move to the bottom of line.</td></tr>
</table>

<p>&lt;Search&gt;</p>
<table border="1">
<tr><td>f/F</td><td>Find First</td></tr>
<tr><td>n/N</td><td>Find Next</td></tr>
<tr><td>p/P</td><td>Find Previous</td></tr>
</table>

<p>&lt;Edit&gt;</p>
<table border="1">
<tr><td>a/A</td><td>Add an entry.</td></tr>
<tr><td>Enter</td><td>Edit ACLs of a domain at the cursor position. (Valid only for screen for domain listing.)</td></tr>
<tr><td>Space</td><td>Invert selection state of an entry at the cursor position.</td></tr>
<tr><td>c/C</td><td>Copy selection state of an entry at the cursor position to all entries below the cursor position.</td></tr>
<tr><td>d/D</td><td>Delete selected entries.</td></tr>
<tr><td>s/S</td><td>Set profile number of selected entries. (Valid only for screen for domain listing.)</td></tr>
<tr><td>Insert</td><td>Copy an entry at the cursor position to history buffer.</td></tr>
</table>

<p>&lt;Misc&gt;</p>
<table border="1">
<tr><td>q/Q</td><td>Quit</td></tr>
<tr><td>r/R</td><td>Refresh</td></tr>
<tr><td>Tab</td><td>Switch to next screen.</td></tr>
</table>

<h3><a name="editpolicy_offline">&lt;Off-line Policy Editor "editpolicy_offline"&gt;</a></h3>
<p>Edits the policy in /etc/ccs/ directory.</p>
<p>The usage is the same as "editpolicy".</p>

<h3><a name="loadpolicy"><a name="loadpolicy">&lt;Policy Loader "loadpolicy"&gt;</a></h3>
<p>Reloads the on-disk policy onto memory.</p>
<p>There are the following commandline parameters.</p>
<ul>
<li>s --- Reload system policy.
<li>e --- Reload exception policy.
<li>d --- Reload domain policy.
<li>a --- Reload the above three policies.
<li>f --- Erase on-memory policy before loading.
</ul>

<h3><a name="setlevel">&lt;Control Level Changer "setlevel"&gt;</a></h3>
<p>Changes the current control level (i.e. writing to /proc/ccs/status ) and displays the new control level.</p>
<p>You can give the new control level from commandline parameter.</p>

<h3><a name="setprofile">&lt;Profile Selector "setprofile"&gt;</a></h3>
<p>Assigns a profile to domains.</p>
<p>You can give the new profile number and domainnames from the commandline parameter. The list of domainnames that the profile number assigned to has changed is printed.</p>

<h3><a name="ccstree">&lt;Process Info Viewer "ccstree"&gt;</a></h3>
<p>Lists the domainnames of currently running processes belong to and the profile numbers the domains currently assigned to.</p>
<p>This program shows the profile number, the name of process, PID, the domainname like "pstree" command.</p>

<h3><a name="savepolicy">&lt;Policy Saver "savepolicy"&gt;</a></h3>
<p>Saves the on-memory policy onto disk.</p>
<p>There are the following commandline parameters.</p>
<ul>
<li>s --- Save system policy.
<li>e --- Save exception policy.
<li>d --- Save domain policy.
<li>a --- Save the above three policies.
<li>f --- Save even if on-memory policy and on-disk policy are same.
</ul>

<h3><a name="makesyaoranconf">&lt;Template Generator for SYAORAN Filesystem "makesyaoranconf"&gt;</a></h3>
<p>Generates syaoran.conf, the configuration file for SYAORAN (the Tamper-Proof /dev filesystem). You can use SYAORAN filesystem if you want to run the system with read-only root fs or you want to prevent device files from tampering.</p>
<p>You can't create files that are not listed in the configuration file. If the system creates device files dynamically, attach all necessary devices before executing this program to ensure all device files are listed in the configuration file.</p>

<h3><a name="ccs-auditd">&lt;Access Log Reading Daemon "ccs-auditd"&gt;</a></h3>
<p>Reads from /proc/ccs/info/grant_log and /proc/ccs/info/reject_log and writes to the location given in the commandline parameters.</p>
<p>The first commandline parameter is the location of access granted log. The second one is the location of access rejected log. You may give /dev/null as the location. If you needn't to save access logs, you needn't to run this program.</p>
<p>This program runs as a daemon. You can start from /etc/rc.d/rc.local if you are using RedHat Linux. The number of logs that the kernel will keep is given using "MAX_GRANT_LOG=integer" and "MAX_REJECT_LOG=integer" lines in the profile.</p>

<h3><a name="sortpolicy">&lt;Access Log Compressor "sortpolicy"&gt;</a></h3>
<p>Remove duplicated entry from logs written by "ccs-auditd".</p>
<p>Reads logs written by "ccs-auditd" from standard input and sorts by domains and removes duplicated entries and writes to standard output.</p>

<h3><a name="findtemp">&lt;Temporal Pathnames Detector "findtemp"&gt;</a></h3>
<p>Reads domain policy from standard input and checks the existence of pathnames, and dumps the nonexistent pathnames.</p>
<p>The nonexistent pathnames are likely used as temporary pathnames. So find the naming rules from similar nonexistent pathnames and append the pattern to /etc/ccs/exception_policy.txt and /proc/ccs/policy/exception_policy .</p>
<p>You can pass the content of /etc/ccs/domain_policy.txt or /proc/ccs/policy/domain_policy using redirection or pipes to the standard input of this program.</p>

<h3><a name="ld-watch">&lt;Library Pathnames Updater "ld-watch"&gt;</a></h3>
<p>Appends shared libraries to exception policy automatically using "allow_read" directive when the location of shared libraries in /etc/ld.so.cache has changed.</p>
<p>By running this program while updating packages, you can avoid errors "unable to start applications because shared libraries are unreadable" when the pathnames of shared libraries accessed by general programs has changed.</p>

<h3><a name="ccs-queryd">&lt;Delayed Enforcing Mode Handler "ccs-queryd"&gt;</a></h3>
<p>Detects policy violation and displays the access request. You can tell the system whether the access request should be granted (or granted and policy should be appended to grant the access request) or rejected after you validate the access request.</p>
<p>By running this program while updating packages, you can avoid errors due to insufficient permissions.</p>
<p>Never grant access requests unconditionally. The cause of policy violation is not always updating packages, but may by malicious requests by attackers. If you grant access requests caused by malicious requests by attackers, the system gets intruded.</p>
<p>To enable "delayed enforcing mode", you need to either set "ALLOW_ENFORCE_GRACE=1" in /proc/ccs/status using "setlevel" command or assign a profile whose ALLOW_ENFORCE_GRACE is set to 1 to domains using "setprofile" command.</p>

<h3><a name="checkpolicy">&lt;Policy Syntax Checker "checkpolicy"&gt;</a></h3>
<p>Reads policy files from standard input and checks syntaxes.</p>
<p>Prints errors with line numbers if any.</p>

<h3><a name=".init">&lt;Initial Policy Loader ".init"&gt;</a></h3>
<p>Loads policy files from /etc/ccs/ directory and executes /sbin/init .</p>
<p>Run this program by giving "init=/.init" option to kernel commandline.</p>

<h3><a name="domainmatch">&lt;ACL Searcher "domainmatch"&gt;</a></h3>
<p>This is a "fgrep" for /proc/ccs/policy/domain_policy .</p>

<h3><a name="patternize">&lt;Pathname Pattern Replacer "patternize"&gt;</a></h3>
<p>Reads domain policy from standard input and replaces pathnames with patterns if the pathname matches to patterns given at commandline and writes to standard output. Pathnames that contains execute permission and domainnames won't be patterned.</p>

<h3><a name="make_exception.sh">&lt;Template Generator for Exception Policy "make_alias.sh/make_allow_read.sh/make_exception.sh/make_file_pattern.sh"&gt;</a></h3>
<p>Generates templates for exception policy. You need to review the output because automatically generated exception policy may contain redundant or dangerous entries.</p>

<hr>
<h2><a name="authentication_tool">&lt;&lt;Tools for reinforcing login authentications&gt;&gt;</a></h2>

<h3><a name="falsh">&lt;Restricted login shell for authentication "falsh"&gt;</a></h3>
<p>A tiny shell that has no built-in command such as "kill". You can use this program for login shell ( the shell specified in the /etc/passwd file). You won't need this program if you don't want to reinforce login authentications.</p>
<p>You should make your own programs for additional authentications. You shouldn't use the following example programs without modifications.</p>

<h3><a name="honey">&lt;An example program for password authentication with timings "honey"&gt;</a></h3>
<p>This program fails unless the correct password is typed with the correct time interval. Conventional authentication programs don't check the time interval of typing, but this program does to prevent password brute force attack.</p>
<h3><a name="candy">&lt;An example program for password authentication with time limit "candy"&gt;</a></h3>
<p>This program fails unless the correct password is typed and this program was invoked within 10 seconds after the parent process was invoked. Conventional authentication programs don't check the time interval between the invocation time of parent process and the invocation time of child process, but this program does to prevent password brute force attack.</p>
<h3><a name="groovy">&lt;An example program for lockfile authentication "groovy"&gt;</a></h3>
<p>This program fails while the file /tmp/.lockme exists. This program prompts for password, but doesn't check for password. This program checks for the existence of the file /tmp/.lockme . This program prevents password brute force attack by keeping locked just before you run this program. This is a program for demonstration, and using a filename that are apparent to crackers. You must customize if you want to use.</p>
<h3><a name="checktoken">&lt;An example program for token authentication "gettoken / checktoken"&gt;</a></h3>
<p>This program generates tokens based on the system time. The authentication will succeed if the output of "gettoken" is passwd to the input of "checktoken". These are programs for demonstration, and the algorithm is too poor. You must customize if you want to use.</p>
<h3><a name="chaplet">&lt;An example program for challenge-handshake authentication "chaplet"&gt;</a></h3>
<p>This program displays strings as a challenge data. The authentication will succeed if you input only numerical letters from the challenge data as a response data. This is a program for demonstration, and the algorithm is too poor. You must customize if you want to use.</p>

<h3><a name="timeauth">&lt;An example program for password authentication with timings  "timeauth"&gt;</a></h3>
<p>This is a re-implementation of "honey". Create a script and specify this program as the interpreter for the script.</p>

<h3><a name="mailauth">&lt;An example program for one-time-password authentication using mail "mailauth"&gt;</a></h3>
<p>This program generates one time password and sends it to the user using "mail". The authentication will succeed if the user input the password sent by "mail". To use this program, some mail server application is needed.</p>

<h3><a name="proxy">&lt;A simple port forwarder "proxy"&gt;</a></h3>
<p>This program is used by client side. This program explicitly binds to local port and connects to server so that the server side firewall (such as "iptables") can use packet filtering based on client side's port number.</p>

<hr>
<p><a href="index.html#manual">Return to index</a></p>
<p><a href="http://sourceforge.jp/"><img src="http://sourceforge.jp/sflogo.php?group_id=1973" width="96" height="31" alt="SourceForge.jp"></a></p>
</body>
</html>
