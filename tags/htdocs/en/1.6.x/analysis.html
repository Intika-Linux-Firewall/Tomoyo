<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<meta http-equiv="Content-Style-Type" content="text/css">
<title>Access analysis using TOMOYO Linux</title>
<link rel="stylesheet" href="tomoyo.css" media="all" type="text/css">
</head>
<body>
<p style="text-align:right;"><a href="../../ja/1.6.x/analysis.html">Japanese Page</a></p>
<h1>Access Analysis using TOMOYO Linux</h1>
<p style="text-align:right;">Last modified: $Date$</p>

<p>Since the policy of TOMOYO Linux is represented using pathnames, TOMOYO Linux is applicable for tracing file accesses.<br>
You can use TOMOYO Linux to find how programs access files or what program is creating files on specific directories.</p>

<h1>Preparation</h1>

<h2>Install TOMOYO Linux kernel and tool</h2>

<p>TOMOYO Linux provides some binary kernel packages and binary tool packages for x86 architecture.</p>

<p>If you are using distributions listed below, you can use repository. To install from repository, do the following operation.</p>

<table border="1">
<tr><td>
RedHat Linux 9</td><td>
&nbsp;wget -O /tmp/key 'http://pgp.nic.ad.jp/pks/lookup?op=get&amp;search=0x4B975A98'<br>
&nbsp;rpm --import /tmp/key<br>
&nbsp;curl http://tomoyo.sourceforge.jp/repos/RedHatLinux9/ccs.repo &gt;&gt; /etc/yum.conf<br>
&nbsp;yum install ccs-kernel-smp ccs-tools
</td></tr><tr><td>
Fedora Core 3</td><td>
&nbsp;wget -O /tmp/key 'http://pgp.nic.ad.jp/pks/lookup?op=get&amp;search=0x4B975A98'<br>
&nbsp;rpm --import /tmp/key<br>
&nbsp;wget -O /etc/yum.repos.d/ccs.repo http://tomoyo.sourceforge.jp/repos/FedoraCore3/ccs.repo<br>
&nbsp;yum install ccs-kernel-smp ccs-tools
</td></tr><tr><td>
Fedora Core 4</td><td>
&nbsp;wget -O /tmp/key 'http://pgp.nic.ad.jp/pks/lookup?op=get&amp;search=0x4B975A98'<br>
&nbsp;rpm --import /tmp/key<br>
&nbsp;wget -O /etc/yum.repos.d/ccs.repo http://tomoyo.sourceforge.jp/repos/FedoraCore4/ccs.repo<br>
&nbsp;yum install ccs-kernel-smp ccs-tools
</td></tr><tr><td>
Fedora Core 5</td><td>
&nbsp;wget -O /tmp/key 'http://pgp.nic.ad.jp/pks/lookup?op=get&amp;search=0x4B975A98'<br>
&nbsp;rpm --import /tmp/key<br>
&nbsp;wget -O /etc/yum.repos.d/ccs.repo http://tomoyo.sourceforge.jp/repos/FedoraCore5/ccs.repo<br>
&nbsp;yum install ccs-kernel-smp ccs-tools
</td></tr><tr><td>
Fedora Core 6</td><td>
&nbsp;wget -O /tmp/key 'http://pgp.nic.ad.jp/pks/lookup?op=get&amp;search=0x4B975A98'<br>
&nbsp;rpm --import /tmp/key<br>
&nbsp;wget -O /etc/yum.repos.d/ccs.repo http://tomoyo.sourceforge.jp/repos/FedoraCore6/ccs.repo<br>
&nbsp;yum install ccs-kernel ccs-tools
</td></tr><tr><td>
Fedora 7</td><td>
&nbsp;wget -O /tmp/key 'http://pgp.nic.ad.jp/pks/lookup?op=get&amp;search=0x4B975A98'<br>
&nbsp;rpm --import /tmp/key<br>
&nbsp;wget -O /etc/yum.repos.d/ccs.repo http://tomoyo.sourceforge.jp/repos/Fedora7/ccs.repo<br>
&nbsp;yum install ccs-kernel ccs-tools
</td></tr><tr><td>
Fedora 8</td><td>
&nbsp;wget -O /tmp/key 'http://pgp.nic.ad.jp/pks/lookup?op=get&amp;search=0x4B975A98'<br>
&nbsp;rpm --import /tmp/key<br>
&nbsp;wget -O /etc/yum.repos.d/ccs.repo http://tomoyo.sourceforge.jp/repos/Fedora8/ccs.repo<br>
&nbsp;yum install ccs-kernel ccs-tools
</td></tr><tr><td>
Fedora 9</td><td>
&nbsp;wget -O /tmp/key 'http://pgp.nic.ad.jp/pks/lookup?op=get&amp;search=0x4B975A98'<br>
&nbsp;rpm --import /tmp/key<br>
&nbsp;wget -O /etc/yum.repos.d/ccs.repo http://tomoyo.sourceforge.jp/repos/Fedora9/ccs.repo<br>
&nbsp;yum install ccs-kernel ccs-tools
</td></tr><tr><td>
Fedora 10</td><td>
&nbsp;wget -O /tmp/key 'http://pgp.nic.ad.jp/pks/lookup?op=get&amp;search=0x4B975A98'<br>
&nbsp;rpm --import /tmp/key<br>
&nbsp;wget -O /etc/yum.repos.d/ccs.repo http://tomoyo.sourceforge.jp/repos/Fedora10/ccs.repo<br>
&nbsp;yum install ccs-kernel ccs-tools
</td></tr><tr><td>
CentOS 3.9</td><td>
&nbsp;wget -O /tmp/key 'http://pgp.nic.ad.jp/pks/lookup?op=get&amp;search=0x4B975A98'<br>
&nbsp;rpm --import /tmp/key<br>
&nbsp;curl http://tomoyo.sourceforge.jp/repos/CentOS3/ccs.repo >> /etc/yum.conf<br>
&nbsp;yum install ccs-kernel-smp ccs-tools
</td></tr><tr><td>
CentOS 4.7</td><td>
&nbsp;wget -O /tmp/key 'http://pgp.nic.ad.jp/pks/lookup?op=get&amp;search=0x4B975A98'<br>
&nbsp;rpm --import /tmp/key<br>
&nbsp;wget -O /etc/yum.repos.d/ccs.repo http://tomoyo.sourceforge.jp/repos/CentOS4/ccs.repo<br>
&nbsp;yum install ccs-kernel-smp ccs-tools
</td></tr><tr><td>
CentOS 5.2</td><td>
&nbsp;wget -O /tmp/key 'http://pgp.nic.ad.jp/pks/lookup?op=get&amp;search=0x4B975A98'<br>
&nbsp;rpm --import /tmp/key<br>
&nbsp;wget -O /etc/yum.repos.d/ccs.repo http://tomoyo.sourceforge.jp/repos/CentOS5/ccs.repo<br>
&nbsp;yum install ccs-kernel ccs-tools
</td></tr><tr><td>
Vine Linux 4.2</td><td>
&nbsp;wget -O /tmp/key 'http://pgp.nic.ad.jp/pks/lookup?op=get&amp;search=0x4B975A98'<br>
&nbsp;rpm --import /tmp/key<br>
&nbsp;echo "repomd http://tomoyo.sourceforge.jp/ repos/VineLinux4/" &gt;&gt; /etc/apt/sources.list<br>
&nbsp;apt-get update<br>
&nbsp;apt-get install ccs-kernel ccs-tools
</td></tr><tr><td>
OpenSUSE 10.1</td><td>
&nbsp;curl 'http://pgp.nic.ad.jp/pks/lookup?op=get&search=0x4B975A98' &gt; /tmp/key<br>
&nbsp;rpm --import /tmp/key<br>
&nbsp;rug service-add --type=YUM http://tomoyo.sourceforge.jp/repos/SUSE10.1/ ccs<br>
&nbsp;rug subscribe ccs<br>
&nbsp;rug install ccs-kernel-default ccs-tools
</td></tr><tr><td>
OpenSUSE 10.2</td><td>
&nbsp;curl 'http://pgp.nic.ad.jp/pks/lookup?op=get&search=0x4B975A98' &gt; /tmp/key<br>
&nbsp;rpm --import /tmp/key<br>
&nbsp;rug service-add --type=YUM http://tomoyo.sourceforge.jp/repos/SUSE10.2/ ccs<br>
&nbsp;rug subscribe ccs<br>
&nbsp;rug install ccs-kernel-default ccs-tools
</td></tr><tr><td>
OpenSUSE 10.3</td><td>
&nbsp;zypper addrepo --type=YUM http://tomoyo.sourceforge.jp/repos/SUSE10.3/ ccs<br>
&nbsp;zypper install ccs-kernel-default ccs-tools
</td></tr><tr><td>
OpenSUSE 11.0</td><td>
&nbsp;zypper addrepo --type=YUM http://tomoyo.sourceforge.jp/repos/SUSE11.0/ ccs<br>
&nbsp;zypper install ccs-kernel-default ccs-tools
</td></tr><tr><td>
OpenSUSE 11.1</td><td>
&nbsp;zypper addrepo --type=YUM http://tomoyo.sourceforge.jp/repos/SUSE11.1/ ccs<br>
&nbsp;zypper install ccs-kernel-default ccs-tools
</td></tr>
</table>

<p>If you are using distributions listed below, you can use binary packages. To install binary packages, download the following files and install them.</p>

<table border="1">
<tr><td>
Debian Sarge</td><td>
http://osdn.dl.sourceforge.jp/tomoyo/32750/kernel-image-2.4.27-4-686-smp-ccs1.6.5p1_2.4.27-10sarge7_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32750/kernel-pcmcia-modules-2.4.27-4-686-smp-ccs1.6.5p1_2.4.27-10sarge7_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32750/kernel-image-2.6.8-4-686-smp-ccs1.6.5p1_2.6.8-17sarge1_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32750/ccs-tools_1.6.5-1_i386.deb
</td></tr><tr><td>
Debian Etch</td><td>
http://osdn.dl.sourceforge.jp/tomoyo/32751/linux-image-2.6.18-6-686-ccs1.6.5-i686_2.6.18.dfsg.1-23etch1_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32751/ccs-tools_1.6.5-1_i386.deb
</td></tr><tr><td>
Debian Lenny</td><td>
http://osdn.dl.sourceforge.jp/tomoyo/32752/linux-image-2.6.26-1-686-ccs1.6.5-i686_2.6.26-11_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32752/ccs-tools_1.6.5-1_i386.deb
</td></tr><tr><td>
Asianux 2.0</td><td>
http://osdn.dl.sourceforge.jp/tomoyo/32428/ccs-kernel-smp-2.6.9-42.29AX_tomoyo_1.6.5p1.i686.rpm
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32428/ccs-tools-1.6.5-1.i386.rpm
</td></tr><tr><td>
Asianux 3.0</td><td>
http://osdn.dl.sourceforge.jp/tomoyo/32429/ccs-kernel-2.6.18-53.17AXS3_tomoyo_1.6.5.i686.rpm
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32429/ccs-tools-1.6.5-1.i386.rpm
</td></tr><tr><td>
Ubuntu 6.06</td><td>
http://osdn.dl.sourceforge.jp/tomoyo/32745/linux-image-2.6.15-53-686-ccs1.6.5p1_2.6.15-53.74_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32745/linux-restricted-modules-2.6.15-53-686-ccs1.6.5p1_2.6.15.12-53.4_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32745/ccs-tools_1.6.5-1_i386.deb
</td></tr><tr><td>
Ubuntu 6.10</td><td>
http://osdn.dl.sourceforge.jp/tomoyo/32746/linux-image-2.6.17-12-generic-ccs1.6.5p1_2.6.17.1-12.44_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32746/linux-restricted-modules-2.6.17-12-generic-ccs1.6.5p1_2.6.17.9-12.4_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32746/ccs-tools_1.6.5-1_i386.deb
</td></tr><tr><td>
Ubuntu 7.04</td><td>
http://osdn.dl.sourceforge.jp/tomoyo/32747/linux-image-2.6.20-17-ccs1.6.5p1_2.6.20-17.39_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32747/linux-restricted-modules-2.6.20-17-ccs1.6.5p1_2.6.20.6-17.31_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32747/ccs-tools_1.6.5-1_i386.deb
</td></tr><tr><td>
Ubuntu 7.10</td><td>
http://osdn.dl.sourceforge.jp/tomoyo/32748/linux-image-2.6.22-16-ccs1.6.5p1_2.6.22-16.60_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32748/linux-ubuntu-modules-2.6.22-16-ccs1.6.5p1_2.6.22-16.41_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32748/linux-restricted-modules-2.6.22-16-ccs1.6.5p1_2.6.22.4-16.12_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32748/linux-headers-2.6.22-16-ccs1.6.5p1_2.6.22-16.60_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32748/ccs-tools_1.6.5-1_i386.deb
</td></tr><tr><td>
Ubuntu 8.04</td><td>
http://osdn.dl.sourceforge.jp/tomoyo/32749/linux-image-2.6.24-23-ccs1.6.6_2.6.24-23.48_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32749/linux-ubuntu-modules-2.6.24-23-ccs1.6.6_2.6.24-23.36_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32749/linux-restricted-modules-2.6.24-23-ccs1.6.6_2.6.24.16-23.56_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32749/linux-headers-2.6.24-23-ccs1.6.6_2.6.24-23.48_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32749/linux-headers-lum-2.6.24-23-ccs1.6.6_2.6.24-23.36_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/32749/ccs-tools_1.6.6-1_i386.deb
</td></tr><tr><td>
Ubuntu 8.10</td><td>
http://osdn.dl.sourceforge.jp/tomoyo/33545/linux-image-2.6.27-9-ccs1.6.5p1_2.6.27-9.19_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/33545/linux-restricted-modules-2.6.27-9-ccs1.6.5p1_2.6.27-9.13_i386.deb
<br>
http://osdn.dl.sourceforge.jp/tomoyo/33545/ccs-tools_1.6.5-1_i386.deb
</td></tr>
</table>

<p>If you are using Gentoo, see <a href="compile.html#Gentoo">TOMOYO Linux kernel compilation for Gentoo</a>. To install tools for Gentoo, run "emerge ccs-tools".</p>

<p>If the CPU architecture differs or you want to customize kernel configuration, you need to compile kernel. To compile kernel, see <a href="compile.html">TOMOYO Linux kernel compilation</a>. To compile tool, run the following commands.</p>

<table border="1">
<tr><td>
wget http://osdn.dl.sourceforge.jp/tomoyo/30298/ccs-tools-1.6.6-20090202.tar.gz<br>
tar -zxf ccs-tools-1.6.6-20090202.tar.gz<br>
make -C ccstools/ install
</td></tr>
</table>

<h2>Create Policy</h2>

<p>Create /etc/ccs/profile.conf with the following contents.</p>

<table border="1">
<tr><td>
MAC_FOR_FILE=learning<BR>
MAX_ACCEPT_ENTRY=1048576<BR>
MAX_GRANT_LOG=0<BR>
MAX_REJECT_LOG=0<BR>
TOMOYO_VERBOSE=disabled<BR>
</td></tr>
</table>

<p>Run the following command.</p>

<table border="1">
<tr><td>
/usr/lib/ccs/init_policy.sh
</td></tr>
</table>

<h1>Analysis</h1>

<p>Reboot with TOMOYO Linux kernel.</p>

<p>Run applications you want to analyze.</p>

<p>You can see the list of programs executed until now by executing /usr/sbin/ccs-editpolicy . Choose a program and press "Enter" to see the list of files accessed by the program. See <a href="tool-editpolicy.html">How to use Policy Editor</a> for usage of the policy editor.</p>

<p>You can save the list of all accessed files until now as /etc/ccs/domain_policy.conf by executing /usr/sbin/ccs-savepolicy .</p>
<p><a href="http://sourceforge.jp/"><img src="http://sourceforge.jp/sflogo.php?group_id=1973" width="96" height="31" alt="SourceForge.jp"></a></p>
</body>
</html>
