Kconfig and Makefile for TOMOYO Linux.
TOMOYO Linux is placed in security/tomoyo .

Signed-off-by: Kentaro Takeda <takedakn@nttdata.co.jp>
Signed-off-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>
 security/Kconfig         |    1 +
 security/Makefile        |    1 +
 security/tomoyo/Kconfig  |   27 +++++++++++++++++++++++++++
 security/tomoyo/Makefile |    3 +++
 4 files changed, 32 insertions(+)

--- linux-2.6.23.orig/security/Kconfig	2007-11-01 13:10:53.000000000 +0900
+++ linux-2.6.23/security/Kconfig	2007-11-01 13:11:06.000000000 +0900
@@ -94,6 +94,7 @@ config SECURITY_ROOTPLUG
 	  If you are unsure how to answer this question, answer N.
 
 source security/selinux/Kconfig
+source security/tomoyo/Kconfig
 
 endmenu
 
--- linux-2.6.23.orig/security/Makefile	2007-11-01 13:10:53.000000000 +0900
+++ linux-2.6.23/security/Makefile	2007-11-01 13:29:19.000000000 +0900
@@ -10,6 +10,7 @@ ifneq ($(CONFIG_SECURITY),y)
 obj-y		+= commoncap.o
 endif
 
+obj-$(CONFIG_SECURITY_TOMOYO)           += tomoyo/
 # Object file lists
 obj-$(CONFIG_SECURITY)			+= security.o dummy.o inode.o
 # Must precede capability.o in order to stack properly.
--- /dev/null	1970-01-01 00:00:00.000000000 +0000
+++ linux-2.6.23/security/tomoyo/Kconfig	2007-11-01 17:31:24.883251784 +0900
@@ -0,0 +1,27 @@
+config SECURITY_TOMOYO
+	bool "TOMOYO Linux support"
+	depends on SECURITY
+	select SECURITY_NETWORK
+	default n
+	help
+	  This selects TOMOYO Linux.
+
+	  TOMOYO Linux is a domain-based access control method using LSM.
+	  If you answer Y, you will need a policy loader program
+	  (/sbin/tomoyo-init) and some configuration files.
+	  You can get them from
+	  <http://tomoyo.sourceforge.jp/en/2.1.x/>
+
+	  TOMOYO Linux is also applicable to figuring out the behavior
+	  of your system, for TOMOYO uses the canonicalized absolute
+	  pathnames and TreeView style domain transitions.
+
+config SECURITY_TOMOYO_USE_AUDITD
+	bool "Use standard auditing subsystem"
+	depends on SECURITY_TOMOYO && AUDIT
+	default n
+	help
+	  This makes audit logs sent to standard auditing subsystem.
+
+	  Say 'N' here to make audit logs sent to TOMOYO Linux's management
+          interface.
--- /dev/null	1970-01-01 00:00:00.000000000 +0000
+++ linux-2.6.23/security/tomoyo/Makefile	2007-11-01 17:31:24.883251784 +0900
@@ -0,0 +1,3 @@
+obj-$(CONFIG_SECURITY_TOMOYO) += tomoyo.o tomoyo_func.o
+tomoyo_func-objs := domain.o common.o realpath.o audit.o file.o exec.o net.o mount.o signal.o capability.o condition.o
+EXTRA_CFLAGS += -Isecurity/tomoyo/include
