<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en-US">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="content-style-type" content="text/css">
<link rel="stylesheet" href="../../media/tomoyolinux.css" media="all" type="text/css">
<title>TOMOYO Linux 1.8.x : Policy specification : Exception policy syntax</title>
</head>

<body>

<div id="titlebar">
<a href="../../index.html.en"><img src="../../media/tomoyotitle.png" alt="tomoyotitle.png" width="320" height="40" border="0" align="left" title="TOMOYO Linux"></a>
</div>

<div id="navbar" class="tomoyo-documentation">
<ul id="navbarlist">
<li id="tomoyo-home"><a href="../../index.html.en" title="TOMOYO Linux Home Page">Home</a></li>
<li id="tomoyo-about"><a href="../../about.html.en" title="About TOMOYO Linux">About</a></li>
<li id="tomoyo-download"><a href="../../download.html.en" title="Get TOMOYO Linux">Download</a></li>
<li id="tomoyo-changelogs"><a href="../../changelogs.html.en" title="TOMOYO Linux ChangeLogs">ChangeLogs</a></li>
<li id="tomoyo-documentation"><a href="../../documentation.html.en" title="Official Documentation">Documentation</a></li>
<li id="tomoyo-support"><a href="../../support.html.en" title="Support information">Support</a></li>
<li id="tomoyo-links"><a href="../../links.html.en" title="Links">Links</a></li>
</ul>
<ul id="switch-language">
<li id="tomoyo-switch-language"><a href="exception-policy-syntax.html.ja" title="Go to Japanese page">Japanese page</a></li>
</ul>
</div>

<div id="content">

<div id="documentation">

<div id="navheader">
<p><a href="expression-rules.html.en">&lt;Prev&gt;</a> <a href="index.html.en">&lt;Index&gt;</a> <a href="domain-policy-syntax.html.en">&lt;Next&gt;</a></p>
</div>

<h2>Exception policy syntax</h2>

<h3><a name="acl_group">acl_group</a></h3>

<p>This directive specifies a group entry. This can be referenced to in domain policy by the <a href="domain-policy-syntax.html.en#use_group">use_group</a> directive. This directive should be followed by a group number, followed by an entry that matches domain policy syntax.</p>

<p>This example allows domains with "use_group 0" to read /dev/null:</p>

<pre>
acl_group 0 file read /dev/null
</pre>

<h3><a name="default_transition">default_transition</a></h3>

<p>This directive controls how domain transition should be done when domain transition was not explicitly specified by <a href="domain-policy-syntax.html.en#file_execute">file execute</a> directive.</p>

<p>Possible entries:</p>
<ul>
<li>default_transition $program keep</li>
<li>default_transition $program child</li>
<li>default_transition $program $pathname</li>
<li>default_transition $program $domainname</li>
</ul>

<p>This example causes all executions of <code>/usr/sbin/sshd</code> to be run in "&lt;kernel&gt; /usr/sbin/sshd" domain when executed from domains in "&lt;kernel&gt;" namespace when "file execute /usr/sbin/sshd $domainspec" was not found:</p>

<pre>
default_transition /usr/sbin/sshd &lt;kernel&gt; /usr/sbin/sshd
</pre>

<h3><a name="address_group">address_group</a></h3>

<p>This directive declares a group name that can be used in domain policy to refer to a range of IP addresses.</p>

<p>For example, if suppose the following are defined in exception policy:</p>

<pre>
address_group LOCAL-ADDRESS 10.0.0.0-10.255.255.255
address_group LOCAL-ADDRESS 172.16.0.0-172.31.255.255
address_group LOCAL-ADDRESS 192.168.0.0-192.168.255.255
</pre>

<p>The following can then be defined in domain policy:</p>

<pre>
network inet stream accept @LOCAL-ADDRESS 1024-65535
</pre>

<h3><a name="number_group">number_group</a></h3>

<p>This directive declares a group name that can be used in domain policy to refer to a range of numbers.</p>

<p>For example, if suppose the following are defined in exception policy:</p>

<pre>
number_group CREATE-MODES 0644
number_group CREATE-MODES 0664
</pre>

<p>The following can then be defined in domain policy:</p>

<pre>
file create /tmp/file @CREATE-MODES
</pre>

<h3><a name="path_group">path_group</a></h3>

<p>This directive declares a group name that can be used in domain policy to refer to a range of pathnames.</p>

<p>For example, if suppose the following are defined in exception policy:</p>

<pre>
path_group HOME-DIR-FILE /home/\*/\*
path_group HOME-DIR-FILE /home/\*/\{\*\}/\*
</pre>

<p>The following can then be defined in domain policy:</p>

<pre>
file read @HOME-DIR-FILE
</pre>

</div><!-- documentation -->

</div><!-- content -->

<div id="navfooter">
<hr>
<table>
<tr>
<td class="docs-previous">
<a href="expression-rules.html.en">Prev</a>
</td>
<td class="docs-index">
<a href="index.html.en">Index</a>
</td>
<td class="docs-next">
<a href="domain-policy-syntax.html.en">Next</a>
</td>
</tr>
<tr>
<td class="docs-previous-description">
<p>A3: Expression rules</p>
</td>
<td class="docs-home">
<a href="../index.html.en">Main Index</a>
</td>
<td class="docs-next-description">
<p>A5: Domain policy syntax</p>
</td>
</tr>
</table>
</div>

<div id="footer">
<p class="language">Go to <a href="exception-policy-syntax.html.ja">Japanese page</a>.</p>
<p class="timestamp">Last modified: $Date: 2011-09-27 17:33:51 +0900 (Tue, 27 Sep 2011) $</p>
<p class="trademark">Linux&reg; is a registered trademark of Linus Torvalds world-wide. TOMOYO&reg; is a registered trademark of <a href="http://www.nttdata.co.jp/en/">NTT DATA Corporation</a>.</p>
<p><a href="http://sourceforge.jp/"><img src="http://sourceforge.jp/sflogo.php?group_id=1973" width="96" height="31" alt="sflogo.php" title="SourceForge.jp"></a></p>
</div>

</body>
</html>
