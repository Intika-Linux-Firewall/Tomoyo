---
 security/tomoyo/gc.c   |    2 +-
 security/tomoyo/util.c |    3 ++-
 2 files changed, 3 insertions(+), 2 deletions(-)

--- linux-3.0.orig/security/tomoyo/gc.c
+++ linux-3.0/security/tomoyo/gc.c
@@ -660,7 +660,7 @@ static int tomoyo_gc_thread(void *unused
 	static DEFINE_MUTEX(tomoyo_gc_mutex);
 	if (!mutex_trylock(&tomoyo_gc_mutex))
 		goto out;
-	daemonize("GC for TOMOYO");
+
 	do {
 		tomoyo_collect_entry();
 		if (list_empty(&tomoyo_gc_list))
--- linux-3.0.orig/security/tomoyo/util.c
+++ linux-3.0/security/tomoyo/util.c
@@ -925,7 +925,8 @@ int tomoyo_get_mode(const struct tomoyo_
 		return TOMOYO_CONFIG_DISABLED;
 	mode = tomoyo_profile(ns, profile)->config[index];
 	if (mode == TOMOYO_CONFIG_USE_DEFAULT)
-		mode = tomoyo_profile(ns, profile)->config[category];
+		mode = tomoyo_profile(ns, profile)->config
+			[category + TOMOYO_MAX_MAC_INDEX];
 	if (mode == TOMOYO_CONFIG_USE_DEFAULT)
 		mode = tomoyo_profile(ns, profile)->default_config;
 	return mode & 3;
