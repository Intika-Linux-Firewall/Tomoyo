Subject: TOMOYO: Check directory read permission.

Some users want to restrict reading directories.

Signed-off-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>
---
 security/tomoyo/file.c |    3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

--- security-testing-2.6.orig/security/tomoyo/file.c
+++ security-testing-2.6/security/tomoyo/file.c
@@ -715,8 +715,7 @@ int tomoyo_check_open_permission(struct 
 	struct tomoyo_request_info r;
 	int idx;
 
-	if (!path->mnt ||
-	    (path->dentry->d_inode && S_ISDIR(path->dentry->d_inode->i_mode)))
+	if (!path->mnt)
 		return 0;
 	/*
 	 * Don't check read permission here if called from do_execve().
