<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<meta http-equiv="Content-Style-Type" content="text/css">
<title>TOMOYO Linux Install manual</title>
<link rel="stylesheet" href="https://tomoyo.osdn.jp/tomoyo.css" media="all" type="text/css">
</head>
<body>
<p>This page is for TOMOYO 2.2 (for Linux 2.6.30 - 2.6.35 kernels). Please jump to <a href="../2.3/">this page</a> for TOMOYO 2.3 (for Linux 2.6.36 and later kernels).</p>
<p style="text-align:right;"><a href="enforcing.html.ja">Japanese Page</a></p>
<p style="text-align:right;">Last modified: $Date$</p>
<h1>Phase 5: Restricting your system's behavior.</h1>

<p>This page describes how to use TOMOYO's enforcing mode.</p>

<hr>

<h2>Step 1: Enabling enforcing mode</h2>

<p>After you came to think you have done everything, run the policy editor and change the profile number to 3.</p>

<p>Run the policy editor. Choose target domains and press 's' key and enter '3' and press 'Enter' key.</p>

<p><img src="editpolicy-httpd-set-profile3.png" alt="editpolicy-httpd-set-profile3.png" width="720" height="400"></p>

<p>Now the profile number of the /usr/sbin/httpd and descendant has changed to 3.</p>

<p><img src="editpolicy-httpd-profile3.png" alt="editpolicy-httpd-profile3.png" width="720" height="400"></p>

<p>Press 'q' key to quit the policy editor. Then, run "tomoyo-pstree" and verify that /usr/sbin/httpd processes and descendant are assigned profile number 3.</p>

<p><img src="pstree-httpd3.png" alt="pstree-httpd3.png" width="1020" height="802"></p>

<p>And now, /usr/sbin/httpd processes and descendant are protected by MAC, for the profile 3 was configured for enforcing file accesses control.</p>

<p><img src="editpolicy-profile-list-enforcing.png" alt="editpolicy-profile-list-enforcing.png" width="720" height="400"></p>

<p>Let's try an operation which is permitted by policy.</p>

<p><img src="operation-permitted.png" alt="operation-permitted.png" width="636" height="613"></p>

<p>The operation was successfully completed, for sending mail is permitted by policy.</p>

<p>Let's try an operation which is not permitted by policy.</p>

<p><img src="unix-penguin.png" alt="unix-penguin.png" width="636" height="613"></p>

<p>The operation was rejected. (Seemingly, it looks like it was successfully completed. But actually, the execution of /bin/cat was rejected as you can see warning message by /bin/mail that the input was empty.)</p>

<p><img src="unix-penguin-rejected.png" alt="unix-penguin-rejected.png" width="636" height="613"></p>

<p>If the profile is configured as "TOMOYO_VERBOSE=enabled" (this is default), the "TOMOYO-ERROR:" messages will be printed to the console when policy violation occurs.</p>

<p><img src="enforcing-error.png" alt="enforcing-error.png" width="720" height="400"></p>

<hr>

<p><a href="index.html.en">Return to index page.</a></p>
<p><a href="https://osdn.jp/"><img src="https://osdn.jp/sflogo.php?group_id=1973" width="96" height="31" alt="sflogo.php" title="SourceForge.jp"></a></p>
</body>
</html>
