<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<meta http-equiv="Content-Style-Type" content="text/css">
<title>Access analysis using TOMOYO Linux</title>
<link rel="stylesheet" href="https://tomoyo.osdn.jp/tomoyo.css" media="all" type="text/css">
</head>
<body>
<p>Info: Version <a href="../1.6.x/">1.6.x</a> is available.</p>
<p style="text-align:right;"><a href="../../ja/1.5.x/analysis.html">Japanese Page</a></p>
<h1>Access Analysis using TOMOYO Linux</h1>
<p style="text-align:right;">Last modified: $Date$</p>

<p>Since the policy of TOMOYO Linux is represented using pathnames, TOMOYO Linux is applicable for tracing file accesses.<br>
You can use TOMOYO Linux to find how programs access files or what program is creating files on specific directories.</p>

<h1>Preparation</h1>

<h2>Install TOMOYO Linux kernel</h2>

<p>To compile kernel, see <a href="compile.html">TOMOYO Linux kernel compilation</a>.</p>

<p>If you are using distributions that support SELinux, you might encounter errors while installing packages if SELinux is not disabled. If you see error messages shown below while installing packages, retry after you disable SELinux. You can disable SELinux by either "changing SELINUX=disabled in /etc/selinux/config and reboot" or "adding selinux=0 to the kernel's boot paramaters".</p>

<table border="1">
<tr><td>
[root@localhost ~]# rpm -ihv kernel-smp-2.6.9-78.0.8.EL_tomoyo_1.5.4.i586.rpm<br>
Preparing...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;########################################### [100%]<br>
Error: %pre(kernel-2.6.9-78.0.8.EL_tomoyo_1.5.4.i586) scriptlet failed, exit status 255<br>
Error:&nbsp;&nbsp;&nbsp;install: %pre scriptlet failed (2), skipping kernel-2.6.9-78.0.8.EL_tomoyo_1.5.4
</td></tr>
</table>

<p>TOMOYO Linux itself can coexist with SELinux. You may continue with SELinux enabled if you want.</p>

<h2>Install TOMOYO Linux tools</h2>

<p>To compile tools, run the following commands.</p>

<table border="1">
<tr><td>
# Download source of tools for TOMOYO Linux.<br>
wget -O ccs-tools-1.5.5-20090401.tar.gz 'https://osdn.jp/frs/redir.php?m=jaist&amp;f=/tomoyo/27220/ccs-tools-1.5.5-20090401.tar.gz'<br>
# Extract.<br>
tar -zxf ccs-tools-1.5.5-20090401.tar.gz<br>
# Compile.<br>
make -C ccstools/ all install
</td></tr>
</table>

<h2>Create Policy</h2>

<p>Create /etc/ccs/profile.conf with the following contents.</p>

<table border="1">
<tr><td>
MAC_FOR_FILE=1<BR>
MAX_ACCEPT_ENTRY=1048576<BR>
MAX_GRANT_LOG=0<BR>
MAX_REJECT_LOG=0<BR>
TOMOYO_VERBOSE=0<BR>
</td></tr>
</table>

<p>Run the following command.</p>

<table border="1">
<tr><td>
/usr/lib/ccs/init_policy.sh
</td></tr>
</table>

<h1>Analysis</h1>

<p>Reboot with TOMOYO Linux kernel.</p>

<p>Run applications you want to analyze.</p>

<p>You can see the list of programs executed until now by executing /usr/lib/ccs/editpolicy . Choose a program and press "Enter" to see the list of files accessed by the program. See <a href="tool-editpolicy.html">How to use Policy Editor</a> for usage of the policy editor.</p>

<p>You can save the list of all accessed files until now as /etc/ccs/domain_policy.conf by executing /usr/lib/ccs/savepolicy .</p>
<p><a href="https://osdn.jp/"><img src="https://osdn.jp/sflogo.php?group_id=1973" width="96" height="31" alt="sflogo.php" title="SourceForge.jp"></a></p>
</body>
</html>
